{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"update","dbs","main","kivi","init","Scheduler","N","push","data","Database","vdom","createComponent","Main","setInterval","invalidate","I","nextFrame","write","injectComponent","document","body","addEventListener","./component/main","./data","kivi/lib/scheduler",2,"module","DNode","this","dirty","rev","ENV","scheduler","dataClock","deps","subs","invalidated","ctx","_invalidate","node","create","prototype","reset","dSubs","indexOf","pop","sub","target","commit","./env",3,4,"scheduleMicrotask","cb","action","./dnode","./vdom",5,"_MutationObserverScheduler","_observer","window","MutationObserver","_node","createTextNode","observe","characterData","Frame","flags","writeTaskGroups","writeTasks","readTasks","afterTasks","clock","_actions","_microtasks","_currentFrame","_nextFrame","self","_microtaskScheduler","S_MICROTASK_PENDING","S_RUNNING","tasks","performActions","_handleAnimationFrame","frame","groups","group","task","j","S_FRAMETASK_PENDING","F_WRITE_ANY","F_WRITE_PRIO","F_WRITE","F_READ","F_AFTER","requestNextTick","_toggle","priority","read","after","currentFrame","requestAnimationFrame","actions",6,"shallowEq","b","key","bVal","hasOwnProperty",7,"VNode","tag","type","attrs","style","classes","children","ref","cref","text","content","V_TEXT","$text","element","V_ELEMENT","$element","svg","V_SVG","$svg","component","descriptor","V_COMPONENT","$component","root","V_ROOT","sameType","context","createElement","createElementNS","render","il","setAttribute","setProperty","className","join","classList","add","insertChild","nodeValue","updateAttrs","updateStyle","updateClasses","updateProps","updateChildren","aValue","bValue","removeAttribute","value","removeProperty","aItem","bItem","visited","removed","bIndex","remove","Array","parent","nextRef","insertBefore","moveChild","removeChild","aNode","bNode","unchangedPosition","updateImplicitChildren","updateExplicitChildren","nextPos","next","aStart","bStart","aEnd","bEnd","lastTarget","pos","aStartNode","bStartNode","aEndNode","bEndNode","stop","outer","aLength","bLength","sources","moved","removeOffset","keyIndex","seq","_lis","v","c","p","slice","result","Component","props","C_DIRTY","depth","C_UPDATE_STATE_HOOK","state","_update","C_INIT_HOOK","declareComponent","spec","sflags","updateState","build","attached","detached","C_UPDATE_PROPS_HOOK","C_STATEFUL","C_BUILD_HOOK","C_ATTACHED_HOOK","C_DETACHED_HOOK","C_UPDATE_HOOK","appendChild","attach","TEXT","ELEMENT","COMPONENT","ROOT","C_DISABLE_PROPS_CHECK","DISABLE_PROPS_CHECK","detach","updateView","newRoot","bind","dispose","$t","$e","$s","$c","./utils",8,"_formatElapsed","str","parseFloat","toFixed","minutes","Math","floor","comps","split","seconds","lpad","ms","Popover","_IMPORTANT_CLASS","_WARNING_CLASS","_SUCCESS_CLASS","Entry","db","topFiveQueries","getTopFiveQueries","name","count","queries","qcSpan","qc","q","elapsed","popover","query","col","./popover",9,"_ROOT_CLASSES","rows","id","tbody","./entry",10,"arrow",11,"Query","waiting","_nextId","rand","random","qs","sort"],"mappings":"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","file":"main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar I = 0;\nvar N = 100;\n\nvar kivi = require('kivi');\nvar Scheduler = require('kivi/lib/scheduler');\n\nvar data = require('./data');\nvar Main = require('./component/main');\n\nfunction update(dbs) {\n  for (var i = 0; i < dbs.length; i++) {\n    dbs[i].update();\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  main();\n});\n\nfunction main() {\n  kivi.init(new Scheduler());\n\n  var dbs = [];\n  for (var i = 0; i < N; i++) {\n    dbs.push(new data.Database('cluster' + i));\n    dbs.push(new data.Database('cluster' + i + 'slave'));\n  }\n\n  var main = kivi.vdom.createComponent(Main, {dbs: dbs});\n\n  setInterval(function() {\n    update(dbs);\n    main.invalidate();\n  }, I);\n\n  kivi.nextFrame().write(function() {\n    kivi.vdom.injectComponent(main, document.body);\n  });\n}\n\n},{\"./component/main\":9,\"./data\":11,\"kivi\":4,\"kivi/lib/scheduler\":5}],2:[function(require,module,exports){\n'use strict';\n\nvar ENV = require('./env');\n\nfunction DNode(data) {\n  if (data == null) {\n    this.dirty = true;\n    this.rev = -1;\n    this.data = null;\n  } else {\n    this.dirty = false;\n    this.rev = ENV.scheduler.dataClock;\n    this.data = data;\n  }\n  this.data = data;\n  this.deps = null;\n  this.subs = null;\n  this.invalidated = null;\n  this.ctx = null;\n}\n\nDNode.create = function(data) {\n  if (data === void 0) data = null;\n  return new DNode(data);\n};\n\nDNode.prototype.reset = function() {\n  var deps = this.deps;\n  if (deps != null) {\n    for (var i = 0; i < deps.length; i++) {\n      var dSubs = deps[i].subs;\n      dSubs[dSubs.indexOf(this)] = dSubs[dSubs.length - 1];\n      dSubs.pop();\n    }\n  }\n\n  this.deps = null;\n};\n\nDNode.prototype.sub = function(target) {\n  if (this.deps == null) {\n    this.deps = [];\n  }\n  this.deps.push(target);\n\n  if (target.subs == null) {\n    target.subs = [];\n  }\n  target.subs.push(this);\n};\n\nDNode.prototype.update = function(dirty) {\n  if (dirty) this.rev = ENV.scheduler.dataClock;\n  this.dirty = false;\n};\n\nDNode.prototype.commit = function() {\n  this.rev = ENV.scheduler.dataClock;\n\n  var subs = this.subs;\n  if (subs != null) {\n    for (var i = 0; i < subs.length; i++) {\n      _invalidate(subs[i]);\n    }\n  }\n};\n\nfunction _invalidate(node) {\n  if (!node.dirty) {\n    node.dirty = true;\n\n    if (node.invalidated != null) {\n      node.invalidated.call(node.ctx, node);\n    }\n\n    var subs = node.subs;\n    if (subs != null) {\n      for (var i = 0; i < subs.length; i++) {\n        _invalidate(subs[i]);\n      }\n    }\n\n    node.deps = null;\n    node.subs = null;\n  }\n}\n\nmodule.exports = DNode;\n\n},{\"./env\":3}],3:[function(require,module,exports){\n'use strict';\n\nvar ENV = {\n  scheduler: null\n};\n\nmodule.exports = ENV;\n\n},{}],4:[function(require,module,exports){\n'use strict';\n\nvar ENV = require('./env');\nvar DNode = require('./dnode');\nvar vdom = require('./vdom');\n\nfunction init(scheduler) {\n  ENV.scheduler = scheduler;\n}\n\nfunction nextFrame() {\n  return ENV.scheduler.nextFrame();\n}\n\nfunction scheduleMicrotask(cb) {\n  ENV.scheduler.scheduleMicrotask(cb);\n}\n\nfunction action(cb) {\n  ENV.scheduler.action(cb);\n}\n\nmodule.exports = {\n  ENV: ENV,\n  DNode: DNode,\n  vdom: vdom,\n  init: init,\n  nextFrame: nextFrame,\n  scheduleMicrotask: scheduleMicrotask,\n  action: action\n};\n\n},{\"./dnode\":2,\"./env\":3,\"./vdom\":7}],5:[function(require,module,exports){\n'use strict';\n\nfunction _MutationObserverScheduler(cb) {\n  this._observer = new window.MutationObserver(cb);\n  this._node = document.createTextNode('');\n  this._observer.observe(this._node, {characterData: true});\n}\n\n_MutationObserverScheduler.prototype.requestNextTick = function() {\n  this._toggle ^= 1;\n  this._node.data = this._toggle;\n};\n\nvar F_WRITE_PRIO = 4;\nvar F_WRITE = 8;\nvar F_READ = 16;\nvar F_AFTER = 32;\nvar F_WRITE_ANY = F_WRITE | F_WRITE_PRIO;\n\nfunction Frame() {\n  this.flags = 0|0;\n  this.writeTaskGroups = [];\n  this.writeTasks = null;\n  this.readTasks = null;\n  this.afterTasks = null;\n}\n\nFrame.prototype.write = function(cb, priority) {\n  var group;\n\n  if (priority === void 0) priority = -1;\n\n  if (priority === -1) {\n    this.flags |= F_WRITE;\n    if (this.writeTasks == null) {\n      this.writeTasks = [];\n    }\n    this.writeTasks.push(cb);\n  } else {\n    this.flags |= F_WRITE_PRIO;\n    while (priority >= this.writeTaskGroups.length) {\n      this.writeTaskGroups.push(null);\n    }\n\n    group = this.writeTaskGroups[priority];\n    if (group == null) {\n      group = this.writeTaskGroups[priority] = [];\n    }\n\n    group.push(cb);\n  }\n};\n\nFrame.prototype.read = function(cb) {\n  this.flags |= F_READ;\n  if (this.readTasks == null) {\n    this.readTasks = [];\n  }\n  this.readTasks.push(cb);\n};\n\nFrame.prototype.after = function(cb) {\n  this.flags |= F_AFTER;\n  if (this.afterTasks == null) {\n    this.afterTasks = [];\n  }\n  this.afterTasks.push(cb);\n};\n\nvar S_RUNNING = 1;\nvar S_MICROTASK_PENDING = 2;\nvar S_FRAMETASK_PENDING = 4;\n\nfunction Scheduler() {\n  this.flags = 0|0;\n  this.dataClock = 0;\n  this.clock = -1;\n\n  this._actions = null;\n\n  this._microtasks = null;\n  this._currentFrame = new Frame();\n  this._nextFrame = new Frame();\n\n  var self = this;\n\n  this._microtaskScheduler = new _MutationObserverScheduler(function() {\n    self.flags &= ~S_MICROTASK_PENDING;\n    self.flags |= S_RUNNING;\n    self.clock++;\n\n    var tasks = self._microtasks;\n    if (tasks != null) {\n      self._microtasks = null;\n\n      for (var i = 0; i < tasks.length; i++) {\n        tasks[i]();\n      }\n    }\n\n    self.dataClock++;\n    self.performActions();\n    self.flags &= ~S_RUNNING;\n  });\n\n  this._handleAnimationFrame = function() {\n    var frame;\n    var groups;\n    var group;\n    var task;\n    var i, j;\n\n    self.flags &= ~S_FRAMETASK_PENDING;\n    self.flags |= S_RUNNING;\n    self.clock++;\n\n    frame = self._nextFrame;\n    self._nextFrame = self._currentFrame;\n    self._currentFrame = frame;\n\n    do {\n      while ((frame.flags & F_WRITE_ANY) !== 0) {\n        if ((frame.flags & F_WRITE_PRIO) !== 0) {\n          frame.flags &= ~F_WRITE_PRIO;\n          groups = frame.writeTaskGroups;\n\n          for (i = 0; i < groups.length; i++) {\n            group = groups[i];\n            if (group != null) {\n              groups[i] = null;\n              for (j = 0; j < group.length; j++) {\n                task = group[j];\n                task();\n              }\n            }\n          }\n        }\n\n        if ((frame.flags & F_WRITE) !== 0) {\n          frame.flags &= ~F_WRITE;\n          group = frame.writeTasks;\n          for (i = 0; i < group.length; i++) {\n            task = group[i];\n            task();\n          }\n        }\n      }\n\n      while ((frame.flags & F_READ) !== 0) {\n        frame.flags &= ~F_READ;\n        group = frame.readTasks;\n        frame.readTasks = null;\n\n        for (i = 0; i < group.length; i++) {\n          task = group[i];\n          task();\n        }\n      }\n    } while ((frame.flags & F_WRITE_ANY) !== 0);\n\n    while ((frame.flags & F_AFTER) !== 0) {\n      frame.flags &= ~F_AFTER;\n\n      group = frame.afterTasks;\n      for (i = 0; i < group.length; i++) {\n        task = group[i];\n        task();\n      }\n    }\n\n    self.dataClock++;\n    self.performActions();\n    self.flags &= ~S_RUNNING;\n  };\n};\n\nScheduler.prototype.currentFrame = function() {\n  return this._currentFrame;\n};\n\nScheduler.prototype.nextFrame = function() {\n  if ((this.flags & S_FRAMETASK_PENDING) === 0) {\n    this.flags |= S_FRAMETASK_PENDING;\n    window.requestAnimationFrame(this._handleAnimationFrame);\n  }\n  return this._nextFrame;\n};\n\nScheduler.prototype.scheduleMicrotask = function(cb) {\n  if ((this.flags & S_MICROTASK_PENDING) === 0) {\n    this.flags |= S_MICROTASK_PENDING;\n    this._microtaskScheduler.requestNextTick();\n  }\n\n  if (this._microtasks == null) {\n    this._microtasks = [];\n  }\n\n  this._microtasks.push(cb);\n};\n\nScheduler.prototype.action = function(cb) {\n  if ((this.flags & S_MICROTASK_PENDING) === 0) {\n    this.flags |= S_MICROTASK_PENDING;\n    this._microtaskScheduler.requestNextTick();\n  }\n\n  if (this._actions == null) {\n    this._actions = [];\n  }\n\n  this._actions.push(cb);\n};\n\nScheduler.prototype.performActions = function() {\n  while (this._actions != null) {\n    var actions = this._actions;\n    this._actions = null;\n    for (var i = 0; i < actions.length; i++) {\n      actions[i]();\n    }\n  }\n};\n\nmodule.exports = Scheduler;\n\n},{}],6:[function(require,module,exports){\n'use strict';\n\nfunction shallowEq(a, b) {\n  var key;\n  for (key in a) {\n    var bVal = b[key];\n    if (bVal === void 0 || a[key] !== bVal) {\n      return false;\n    }\n  }\n  for (key in b) {\n    if (!a.hasOwnProperty(key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nmodule.exports = {\n  shallowEq: shallowEq\n};\n\n},{}],7:[function(require,module,exports){\n'use strict';\n\nvar DNode = require('./dnode');\nvar ENV = require('./env');\nvar shallowEq = require('./utils').shallowEq;\n\nvar V_TEXT = 1;\nvar V_ELEMENT = 2;\nvar V_COMPONENT = 8;\nvar V_ROOT = 16;\nvar V_SVG = 32;\n\n/**\n * Virtual Node.\n *\n * @param flags Flags.\n * @param key Key that should be unique among its siblings. If the key\n *   is null, it means that the key is implicit.\n * @param tag When the VNode is Element tag represents its tagName,\n *   and when VNode is a Component it is a ComponentFactory.\n * @param data\n * @constructor\n */\nfunction VNode(flags, key, tag, data) {\n  this.flags = flags;\n  this.key = key;\n  this.tag = tag;\n  this.data = data;\n  this.type = null;\n  this.attrs = null;\n  this.style = null;\n  this.classes = null;\n  this.children = null;\n  this.ref = null;\n  this.cref = null;\n}\n\nVNode.TEXT = V_TEXT;\nVNode.ELEMENT = V_ELEMENT;\nVNode.COMPONENT = V_COMPONENT;\nVNode.ROOT = V_ROOT;\n\nfunction text(content) {\n  return new VNode(V_TEXT, null, null, content);\n};\n\nfunction $text(key, content) {\n  return new VNode(V_TEXT, key, null, content);\n};\n\nfunction element(tag) {\n  return new VNode(V_ELEMENT, null, tag, null);\n};\n\nfunction $element(key, tag) {\n  return new VNode(V_ELEMENT, key, tag, null);\n};\n\nfunction svg(tag) {\n  return new VNode(V_ELEMENT | V_SVG, null, tag, null);\n};\n\nfunction $svg(key, tag) {\n  return new VNode(V_ELEMENT | V_SVG, key, tag, null);\n};\n\nfunction component(descriptor, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_COMPONENT, null, descriptor, data);\n};\n\nfunction $component(key, descriptor, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_COMPONENT, key, descriptor, data);\n};\n\nfunction root() {\n  return new VNode(V_ROOT, null, null, null);\n};\n\n/**\n * Checks if two VNodes have the same type and they can be updated.\n */\nfunction sameType(a, b) {\n  return (a.flags === b.flags && a.tag === b.tag);\n}\n\n/**\n * Create internal state of the VNode.\n */\nfunction create(node, context) {\n  var flags = node.flags;\n\n  if ((flags & V_TEXT) !== 0) {\n    node.ref = document.createTextNode(node.data);\n  } else if ((flags & V_ELEMENT) !== 0) {\n    if ((flags & V_SVG) === 0) {\n      node.ref = document.createElement(node.tag);\n    } else {\n      node.ref = document.createElementNS('http://www.w3.org/2000/svg', node.tag);\n    }\n  } else if ((flags & V_COMPONENT) !== 0) {\n    var component = createComponent(node.tag, node.data, context);\n    node.ref = component.element;\n    node.cref = component;\n  }\n};\n\n/**\n * Render internal representation of the VNode.\n */\nfunction render(node, context) {\n  var i, il;\n  var key;\n  var flags = node.flags;\n\n  if ((flags & (V_ELEMENT | V_COMPONENT | V_ROOT)) !== 0) {\n    var ref = node.ref;\n\n    if (node.attrs != null) {\n      for (key in node.attrs) {\n        ref.setAttribute(key, node.attrs[key]);\n      }\n    }\n\n    if (node.style != null) {\n      var style = ref.style;\n\n      for (key in node.style) {\n        style.setProperty(key, node.style[key]);\n      }\n    }\n\n    if ((flags & V_ELEMENT) !== 0) {\n      var className = null;\n      if (node.type != null) {\n        className = node.type;\n      }\n      if (node.classes != null) {\n        var classes = node.classes.join(' ');\n        className = (className == null) ? classes : className + ' ' + classes;\n      }\n      if (className != null) {\n        node.data = className;\n        ref.className = className;\n      }\n    } else {\n      var classList = null;\n      if (node.type != null) {\n        classList = ref.classList;\n        classList.add(node.type);\n      }\n\n      if (node.classes != null) {\n        if (classList == null) {\n          classList = ref.classList;\n        }\n\n        for (i = 0, il = node.classes.length; i < il; i++) {\n          classList.add(node.classes[i]);\n        }\n      }\n    }\n\n    if ((flags & V_COMPONENT) !== 0) {\n      // node.cref.updateChildren(node.children);\n      node.cref.update();\n    } else if (node.children != null) {\n      for (i = 0, il = node.children.length; i < il; i++) {\n        insertChild(node, node.children[i], null, context);\n      }\n    }\n  }\n};\n\n/**\n * Update VNode. When VNode a is updated with VNode b, VNode a should\n * be considered as destroyed, and any access to it is an undefined\n * behaviour.\n *\n * @param {!VNode} a Old VNode\n * @param {!VNode} b New VNode\n * @param {Context} context\n */\nfunction update(a, b, context) {\n  var ref = a.ref;\n  var flags = a.flags;\n  b.ref = ref;\n\n  if ((flags & V_TEXT) !== 0) {\n    if (a.data != b.data) {\n      a.ref.nodeValue = b.data;\n    }\n\n  } else if ((flags & (V_ELEMENT | V_COMPONENT | V_ROOT)) !== 0) {\n    if (a.attrs !== b.attrs) {\n      updateAttrs(a.attrs, b.attrs, ref);\n    }\n    if (a.style !== b.style) {\n      updateStyle(a.style, b.style, ref.style);\n    }\n\n    if ((flags & V_ELEMENT) !== 0) {\n      var className = null;\n      if (b.type != null) {\n        className = b.type;\n      }\n      if (b.classes != null) {\n        var classes = b.classes.join(' ');\n        className = (className == null) ? classes : className + ' ' + classes;\n      }\n      b.data = className;\n      if (a.data !== b.data) {\n        ref.className = className;\n      }\n    } else if (a.classes !== b.classes) {\n      updateClasses(a.classes, b.classes, ref.classList);\n    }\n\n    if ((flags & V_COMPONENT) !== 0) {\n      var component = b.cref = a.cref;\n      if (a.data !== b.data) {\n        component.updateProps(b.data);\n      }\n      // component.updateChildren()\n      component.update();\n    } else {\n      updateChildren(a, a.children, b.children, context);\n    }\n  }\n};\n\n/**\n * Update HTMLElement attributes.\n *\n * @param a Old attributes.\n * @param b New attributes.\n * @param attributes\n */\nfunction updateAttrs(a, b, node) {\n  var key;\n  var aValue;\n  var bValue;\n\n  if (a != null) {\n    if (b == null) {\n      // b is empty, remove all attributes from a.\n      for (key in a) {\n        node.removeAttribute(key);\n      }\n    } else {\n      // Remove and update attributes.\n      for (key in a) {\n        bValue = b[key];\n        if (bValue === void 0) {\n          node.removeAttribute(key);\n        } else {\n          aValue = a[key];\n          if (aValue !== bValue) {\n            node.setAttribute(key, bValue);\n          }\n        }\n      }\n\n      // Insert new attributes.\n      for (key in b) {\n        aValue = a[key];\n        if (aValue === void 0) {\n          node.setAttribute(key, b[key]);\n        }\n      }\n    }\n  } else if (b != null) {\n    // a is empty, insert all attributes from b.\n    for (key in b) {\n      node.setAttribute(key, b[key]);\n    }\n  }\n}\n\n/**\n * Update HTMLElement styles.\n *\n * @param {Object.<string,string>} a Old style.\n * @param {Object.<string,string>} b New style.\n * @param {CSSStyleDeclaration} style\n */\nfunction updateStyle(a, b, style) {\n  var key;\n  var value;\n\n  if (a != null) {\n    if (b == null) {\n      // b is empty, remove all styles from a.\n      for (key in a) {\n        style.removeProperty(key);\n      }\n    } else {\n      // Remove and update styles.\n      for (key in a) {\n        value = b[key];\n        if (value === void 0) {\n          style.removeProperty(key);\n        } else {\n          style.setProperty(key, value);\n        }\n      }\n\n      // Insert new styles.\n      for (key in b) {\n        value = a[key];\n        if (value === void 0) {\n          style.setProperty(key, b[key]);\n        }\n      }\n    }\n  } else if (b != null) {\n    // a is empty, insert all styles from b.\n    for (key in b) {\n      style.setProperty(key, b[key]);\n    }\n  }\n}\n\n/**\n * Update HTMLElement classes.\n *\n * @param {Array.<string>} a Old classes.\n * @param {Array.<string>} b New classes.\n * @param {DOMTokenList} classList\n */\nfunction updateClasses(a, b, classList) {\n  var i;\n  var j;\n  var key;\n  var aItem;\n  var bItem;\n  var visited;\n  var removed;\n  var bIndex;\n\n  if (a != null && a.length > 0) {\n    if (b == null || b.length === 0) {\n      // b is empty, remove all classes from a.\n      for (i = 0; i < a.length; i++) {\n        classList.remove(a[i]);\n      }\n    } else {\n      // When lists a and b are small, we are using naive O(M*N) algorithm\n      // to find differences.\n      if (a.length * b.length <= 16) {\n        visited = new Array(b.length);\n\n        for (i = 0; i < a.length; i++) {\n          aItem = a[i];\n          removed = true;\n\n          for (j = 0; j < b.length; j++) {\n            bItem = b[j];\n\n            if (aItem === bItem) {\n              removed = false;\n              visited[j] = true;\n              break;\n            }\n          }\n\n          if (removed) {\n            classList.remove(aItem);\n          }\n        }\n\n        for (i = 0; i < b.length; i++) {\n          if (visited[i] != true) {\n            classList.add(b[i]);\n          }\n        }\n      } else {\n        bIndex = {};\n\n        for (i = 0; i < b.length; i++) {\n          bItem = b[i];\n          bIndex[bItem] = false;\n        }\n\n        for (i = 0; i < a.length; i++) {\n          aItem = a[i];\n          if (bIndex[aItem] === void 0) {\n            classList.remove(aItem);\n          } else {\n            bIndex[aItem] = true;\n          }\n        }\n\n        for (key in bIndex) {\n          if (bIndex[key] === false) {\n            classList.add(key);\n          }\n        }\n      }\n    }\n  } else if (b != null && b.length > 0) {\n    // a is empty, insert all classes from b.\n    for (i = 0; i < b.length; i++) {\n      classList.add(b[i]);\n    }\n  }\n}\n\n/**\n * Insert VNode.\n *\n * @param {VNode} parent Parent node.\n * @param {VNode} node Node to insert.\n * @param {HTMLElement} b Reference to the next html element.\n * @param {Context} context Current context.\n */\nfunction insertChild(parent, node, nextRef, context) {\n  create(node, context);\n  parent.ref.insertBefore(node.ref, nextRef);\n  // if (content.isAttached) attached(node);\n  render(node, context);\n}\n\n/**\n * Move VNode.\n *\n * @param {VNode} parent Parent node.\n * @param {VNode} node Node to move.\n * @param {HTMLElement} b Reference to the next html element.\n * @param {Context} context Current context.\n */\nfunction moveChild(parent, node, nextRef, context) {\n  parent.ref.insertBefore(node.ref, nextRef);\n}\n\n/**\n * Remove VNode.\n *\n * @param {VNode} parent Parent node.\n * @param {VNode} node Node to remove.\n * @param {Context} context Current context.\n */\nfunction removeChild(parent, node, context) {\n  parent.ref.removeChild(node.ref);\n  // dispose(node);\n}\n\n/**\n * Update childrens [a] and [b] in the [parent].\n *\n * If one of the childrens has `null` `key`, it will run update\n * algorithm for childrens with implicit keys, otherwise it will run\n * update algorithm for childrens with explicit keys.\n *\n * Mixing childrens with explicit and implicit keys in one children\n * list will result in undefined behaviour. In development mode it\n * will be checked for this conditions and if it is detected that\n * there are childrens with implicit and explicit keys, it will result\n * in runtime error.\n *\n * @param {VNode} parent Childrens parent.\n * @param {Array.<VNode>} a Old children list.\n * @param {Array.<VNode>} b New children list.\n * @param {Context} context Current context.\n */\nfunction updateChildren(parent, a, b, context) {\n  var aNode;\n  var bNode;\n  var i;\n  var unchangedPosition;\n\n  if (a != null && a.length !== 0) {\n    if (b == null || b.length === 0) {\n      // b is empty, remove all children from a.\n      for (i = 0; i < a.length; i++) {\n        removeChild(parent, a[i], context);\n      }\n    } else {\n      if (a.length === 1 && b.length === 1) {\n        // Fast path when a and b have only one child.\n        aNode = a[0];\n        bNode = b[0];\n\n        // Implicit key with same type or explicit key with same key.\n        if ((aNode.key == null && sameType(aNode, bNode)) ||\n            (aNode.key != null && aNode.key === bNode.key)) {\n          update(aNode, bNode, context);\n        } else {\n          removeChild(parent, aNode, context);\n          insertChild(parent, bNode, null, context);\n        }\n      } else if (a.length === 1) {\n        // Fast path when a have 1 child.\n        aNode = a[0];\n        if (aNode.key == null) {\n          updateImplicitChildren(parent, a, b, context);\n        } else {\n          unchangedPosition = -1;\n          for (i = 0; i < b.length; i++) {\n            bNode = b[i];\n            if (aNode.key === bNode.key) {\n              unchangedPosition = i;\n              break;\n            } else {\n              insertChild(parent, bNode, aNode.ref, context);\n            }\n          }\n          if (unchangedPosition !== -1) {\n            for (i = unchangedPosition + 1; i < b.length; i++) {\n              insertChild(parent, b[i], null, context);\n            }\n            update(aNode, b[unchangedPosition], context);\n          } else {\n            removeChild(parent, aNode, context);\n          }\n        }\n      } else if (b.length === 1) {\n        // Fast path when b have 1 child.\n        bNode = b[0];\n        if (bNode.key == null) {\n          updateImplicitChildren(parent, a, b, context);\n        } else {\n          unchangedPosition = -1;\n          for (i = 0; i < a.length; i++) {\n            aNode = a[i];\n            if (aNode.key === bNode.key) {\n              unchangedPosition = i;\n              break;\n            } else {\n              removeChild(parent, aNode, context);\n            }\n          }\n          if (unchangedPosition !== -1) {\n            for (i = unchangedPosition + 1; i < a.length; i++) {\n              removeChild(parent, a[i], context);\n            }\n            update(a[unchangedPosition], bNode, context);\n          } else {\n            insertChild(parent, bNode, null, context);\n          }\n        }\n      } else {\n        // a and b have more than 1 child.\n        if (a[0].key == null) {\n          updateImplicitChildren(parent, a, b, context);\n        } else {\n          updateExplicitChildren(parent, a, b, context);\n        }\n      }\n    }\n  } else if (b != null && b.length > 0) {\n    // a is empty, insert all children from b\n    for (i = 0; i < b.length; i++) {\n      insertChild(parent, b[i], null, context);\n    }\n  }\n}\n\n/**\n * Update childrens with implicit keys `a` and `b` in the `parent`.\n *\n * Any heuristics that is used in this algorithm is an undefined\n * behaviour, and external dependencies should not relay on the\n * knowledge about this algorithm, because it can be changed in any\n * time.\n *\n * @param {VNode} parent Childrens parent.\n * @param {Array.<VNode>} a Old children list.\n * @param {Array.<VNode>} b New children list.\n * @param {Context} context Current context.\n */\nfunction updateImplicitChildren(parent, a, b, context) {\n  var aStart = 0;\n  var bStart = 0;\n  var aEnd = a.length - 1;\n  var bEnd = b.length - 1;\n  var aNode;\n  var bNode;\n  var nextPos;\n  var next;\n\n  // Update nodes with the same type at the beginning.\n  while (aStart <= aEnd && bStart <= bEnd) {\n    aNode = a[aStart];\n    bNode = b[bStart];\n\n    if (!sameType(aNode, bNode)) {\n      break;\n    }\n\n    aStart++;\n    bStart++;\n\n    update(aNode, bNode, context);\n  }\n\n  // Update nodes with the same type at the end.\n  while (aStart <= aEnd && bStart <= bEnd) {\n    aNode = a[aEnd];\n    bNode = b[bEnd];\n\n    if (!sameType(aNode, bNode)) {\n      break;\n    }\n\n    aEnd--;\n    bEnd--;\n\n    update(aNode, bNode, context);\n  }\n\n  // Iterate through the remaining nodes and if they have the same\n  // type, then update, otherwise just remove the old node and insert\n  // the new one.\n  while (aStart <= aEnd && bStart <= bEnd) {\n    aNode = a[aStart++];\n    bNode = b[bStart++];\n    if (sameType(aNode, bNode)) {\n      update(aNode, bNode, context);\n    } else {\n      insertChild(parent, bNode, aNode.ref, context);\n      removeChild(parent, aNode, context);\n    }\n  }\n\n  // All nodes from a are updated, insert the rest from b.\n  while (aStart <= aEnd) {\n    removeChild(parent, a[aStart++], context);\n  }\n\n  nextPos = bEnd + 1;\n  next = nextPos < b.length ? b[nextPos].ref : null;\n\n  // All nodes from b are updated, remove the rest from a.\n  while (bStart <= bEnd) {\n    insertChild(parent, b[bStart++], next, context);\n  }\n}\n\n/**\n * Update childrens with explicit keys [a] and [b] in the [parent].\n *\n * @param {VNode} parent Childrens parent.\n * @param {Array.<VNode>} a Old children list.\n * @param {Array.<VNode>} b New children list.\n * @param {Context} context Current context.\n */\nfunction updateExplicitChildren(parent, a, b, context) {\n  var aStart = 0;\n  var bStart = 0;\n  var aEnd = a.length - 1;\n  var bEnd = b.length - 1;\n  var aStartNode = a[aStart];\n  var bStartNode = b[bStart];\n  var aEndNode = a[aEnd];\n  var bEndNode = b[bEnd];\n  var i;\n  var j;\n  var stop = false;\n  var nextPos;\n  var next;\n  var aNode;\n  var bNode;\n  var lastTarget;\n  var pos;\n  var node;\n\n  // Algorithm that works on simple cases with basic list\n  // transformations.\n  //\n  // It tries to reduce the diff problem by simultaneously iterating\n  // from the beginning and the end of both lists, if keys are the\n  // same, they're updated, if node is moved from the beginnin to the\n  // end of the current cursor positions or vice versa it just\n  // performs move operation and continues to reduce the diff problem.\n  outer: do {\n    stop = true;\n\n    // Update nodes with the same key at the beginning.\n    while (aStartNode.key === bStartNode.key) {\n      update(aStartNode, bStartNode, context);\n      aStart++;\n      bStart++;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aStartNode = a[aStart];\n      bStartNode = b[bStart];\n      stop = false;\n    }\n\n    // Update nodes with the same key at the end.\n    while (aEndNode.key === bEndNode.key) {\n      update(aEndNode, bEndNode, context);\n      aEnd--;\n      bEnd--;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aEndNode = a[aEnd];\n      bEndNode = b[bEnd];\n      stop = false;\n    }\n\n    // Move nodes from left to right.\n    while (aStartNode.key === bEndNode.key) {\n      update(aStartNode, bEndNode, context);\n      nextPos = bEnd + 1;\n      next = nextPos < b.length ? b[nextPos].ref : null;\n      moveChild(parent, bEndNode, next, context);\n      aStart++;\n      bEnd--;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aStartNode = a[aStart];\n      bEndNode = b[bEnd];\n      stop = false;\n      continue outer;\n    }\n\n    // Move nodes from right to left.\n    while (aEndNode.key === bStartNode.key) {\n      update(aEndNode, bStartNode, context);\n      moveChild(parent, bStartNode, aStartNode.ref, context);\n      aEnd--;\n      bStart++;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aEndNode = a[aEnd];\n      bStartNode = b[bStart];\n      stop = false;\n    }\n  } while (!stop && aStart <= aEnd && bStart <= bEnd);\n\n  if (aStart > aEnd) {\n    // All nodes from a are updated, insert the rest from b.\n    nextPos = bEnd + 1;\n    next = nextPos < b.length ? b[nextPos].ref : null;\n    while (bStart <= bEnd) {\n      insertChild(parent, b[bStart++], next, context);\n    }\n  } else if (bStart > bEnd) {\n    // All nodes from b are updated, remove the rest from a.\n    while (aStart <= aEnd) {\n      removeChild(parent, a[aStart++], context);\n    }\n  } else {\n    // Perform more complex update algorithm on the remaining nodes.\n    //\n    // We start by marking all nodes from b as inserted, then we try\n    // to find all removed nodes and simultaneously perform updates on\n    // the nodes that exists in both lists and replacing \"inserted\"\n    // marks with the position of the node from the list b in list a.\n    // Then we just need to perform slightly modified LIS algorith,\n    // that ignores \"inserted\" marks and find common subsequence and\n    // move all nodes that doesn't belong to this subsequence, or\n    // insert if they have \"inserted\" mark.\n    var aLength = aEnd - aStart + 1;\n    var bLength = bEnd - bStart + 1;\n    var sources = new Array(bLength);\n\n    // Mark all nodes as inserted.\n    for (i = 0; i < bLength; i++) {\n      sources[i] = -1;\n    }\n\n    var moved = false;\n    var removeOffset = 0;\n\n    // When lists a and b are small, we are using naive O(M*N) algorithm\n    // to find removed children.\n    if (aLength * bLength <= 16) {\n      for (i = aStart; i <= aEnd; i++) {\n        var removed = true;\n        aNode = a[i];\n        for (j = bStart; j <= bEnd; j++) {\n          bNode = b[j];\n          if (aNode.key === bNode.key) {\n            sources[j - bStart] = i;\n\n            if (lastTarget > j) {\n              moved = true;\n            } else {\n              lastTarget = j;\n            }\n            update(aNode, bNode, context);\n            removed = false;\n            break;\n          }\n        }\n        if (removed) {\n          removeChild(parent, aNode, context);\n          removeOffset++;\n        }\n      }\n    } else {\n      var keyIndex = {};\n\n      for (i = bStart; i <= bEnd; i++) {\n        node = b[i];\n        keyIndex[node.key] = i;\n      }\n\n      for (i = aStart; i <= aEnd; i++) {\n        aNode = a[i];\n        j = keyIndex[aNode.key];\n\n        if (j != null) {\n          bNode = b[j];\n          sources[j - bStart] = i;\n          if (lastTarget > j) {\n            moved = true;\n          } else {\n            lastTarget = j;\n          }\n          update(aNode, bNode, context);\n        } else {\n          removeChild(parent, aNode, context);\n          removeOffset++;\n        }\n      }\n    }\n\n    if (moved) {\n      var seq = _lis(sources);\n      // All modifications are performed from the right to left, so we\n      // can use insertBefore method and use reference to the html\n      // element from the next VNode. All Nodes from the right side\n      // should always be in the correct state.\n      j = seq.length - 1;\n      for (i = bLength - 1; i >= 0; i--) {\n        if (sources[i] === -1) {\n          pos = i + bStart;\n          node = b[pos];\n          nextPos = pos + 1;\n          next = nextPos < b.length ? b[nextPos].ref : null;\n          insertChild(parent, node, next, context);\n        } else {\n          if (j < 0 || i != seq[j]) {\n            pos = i + bStart;\n            node = b[pos];\n            nextPos = pos + 1;\n            next = nextPos < b.length ? b[nextPos].ref : null;\n            moveChild(parent, node, next, context);\n          } else {\n            j--;\n          }\n        }\n      }\n    } else if (aLength - removeOffset != bLength) {\n      for (i = bLength - 1; i >= 0; i--) {\n        if (sources[i] === -1) {\n          pos = i + bStart;\n          node = b[pos];\n          nextPos = pos + 1;\n          next = nextPos < b.length ? b[nextPos].ref : null;\n          insertChild(parent, node, next, context);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Slightly modified Longest Increased Subsequence algorithm, it\n * ignores items that have -1 value. They're representing new items.\n *\n * This algorithm is used to find minimum number of move operations\n * when updating childrens with explicit keys.\n *\n * http://en.wikipedia.org/wiki/Longest_increasing_subsequence\n *\n * @param {Array.<number>} a\n * @return {Array.<number>}\n */\nfunction _lis(a) {\n  var p = a.slice(0);\n  var result = [0];\n  var i, il;\n  var j;\n  var u;\n  var v;\n  var c;\n\n  for (i = 0, il = a.length; i < il; i++) {\n    if (a[i] === -1) {\n      continue;\n    }\n\n    j = result[result.length - 1];\n    if (a[j] < a[i]) {\n      p[i] = j;\n      result.push(i);\n      continue;\n    }\n\n    u = 0;\n    v = result.length - 1;\n\n    while (u < v) {\n      c = ((u + v) / 2) | 0;\n      if (a[result[c]] < a[i]) {\n        u = c + 1;\n      } else {\n        v = c;\n      }\n    }\n\n    if (a[i] < a[result[u]]) {\n      if (u > 0) {\n        p[i] = result[u - 1];\n      }\n      result[u] = i;\n    }\n  }\n\n  u = result.length;\n  v = result[u - 1];\n\n  while (u-- > 0) {\n    result[u] = v;\n    v = p[v];\n  }\n\n  return result;\n}\n\n/**\n * Components\n */\nvar C_DIRTY = 1;\nvar C_STATEFUL = 2;\nvar C_DOM_ATTACHED = 4;\nvar C_RENDERED = 8;\nvar C_MOUNTED = 16;\nvar C_DISABLE_PROPS_CHECK = 32;\nvar C_UPDATE_PROPS_HOOK = 128;\nvar C_UPDATE_STATE_HOOK = 256;\nvar C_INIT_HOOK = 512;\nvar C_BUILD_HOOK = 1024;\nvar C_ATTACHED_HOOK = 2048;\nvar C_DETACHED_HOOK = 4096;\nvar C_UPDATE_HOOK = 65536;\n\n/**\n * Component.\n *\n * @param {!Object} descriptor Component descriptor object.\n * @param {!Component} parent Parent component.\n * @param {Object} data Component data.\n * @final\n * @constructor\n * @struct\n */\nfunction Component(descriptor, parent, props) {\n  var flags = descriptor.flags;\n\n  /**\n   * Component flags.\n   * @type {number}\n   */\n  this.flags = flags | C_DIRTY;\n\n  /**\n   * ComponentDescriptor.\n   * @type {!Object}\n   */\n  this.descriptor = descriptor;\n\n  /**\n   * Depth relative to other Components.\n   * @type {number}\n   */\n  this.depth = parent == null ? 0 : parent.depth + 1;\n\n  /**\n   * Parent Component.\n   * @type {Component}\n   */\n  this.parent = parent;\n\n  this.props = props;\n\n  /**\n   * Component State.\n   * @type {!DNode}\n   */\n  if ((flags & C_UPDATE_STATE_HOOK) === 0) {\n    this.state = null;\n  } else {\n    this.state = DNode.create();\n    this.state.invalidated = this.invalidate;\n    this.state.ctx = this;\n  }\n\n  this.rev = -1;\n\n  /**\n   * Root node in the Components virtual tree.\n   * @type {VNode}\n   */\n  this.root = null;\n\n  /**\n   * Reference to the Html Element.\n   * @type {HTMLElement}\n   */\n  this.element = document.createElement(descriptor.tag);\n\n  /**\n   * updateLater bound method.\n   * @type {function(this:!Component)}\n   */\n  this._update = null;\n\n  if ((flags & C_INIT_HOOK) !== 0) {\n    descriptor.init.call(this);\n  }\n}\n\nComponent.DISABLE_PROPS_CHECK = C_DISABLE_PROPS_CHECK;\n\n/**\n * Create Component Descriptor Object\n * @nosideeffects\n * @param {!Object} decl Component declaration\n * @return {!Object}\n */\nfunction declareComponent(spec) {\n  var flags = 0|0;\n  var sflags = spec.flags;\n  var tag = spec.tag;\n  var updateProps = spec.updateProps;\n  var updateState = spec.updateState;\n  var init = spec.init;\n  var build = spec.build;\n  var attached = spec.attached;\n  var detached = spec.detached;\n  var update = spec.update;\n\n  if (sflags !== void 0) flags |= sflags;\n\n  if (tag === void 0) tag = 'div';\n\n  if (updateProps === void 0) updateProps = null;\n  else flags |= C_UPDATE_PROPS_HOOK;\n\n  if (updateState === void 0) updateState = null;\n  else flags |= C_STATEFUL | C_UPDATE_STATE_HOOK;\n\n  if (init === void 0) init = null;\n  else flags |= C_INIT_HOOK;\n\n  if (build === void 0) build = null;\n  else flags |= C_BUILD_HOOK;\n\n  if (attached === void 0) attached = null;\n  else flags |= C_ATTACHED_HOOK;\n\n  if (detached === void 0) detached = null;\n  else flags |= C_DETACHED_HOOK;\n\n  if (update === void 0) update = null;\n  else flags |= C_UPDATE_HOOK;\n\n  return {\n    flags: flags,\n    updateProps: updateProps,\n    updateState: updateState,\n    init: init,\n    build: build,\n    attached: attached,\n    detached: detached,\n    update: update,\n    tag: tag\n  };\n};\n\nfunction createComponent(descriptor, props, ctx) {\n  return new Component(descriptor, ctx, props);\n};\n\nComponent.prototype.attach = function() {};\nComponent.prototype.detach = function() {};\n\nComponent.prototype.updateProps = function(props) {\n  var flags = this.flags;\n  if ((flags & C_UPDATE_PROPS_HOOK) !== 0) {\n    if (this.descriptor.updateProps.call(this, props)) {\n      this.flags |= C_DIRTY;\n    }\n  } else if (((flags & C_DISABLE_PROPS_CHECK) !== 0) || !shallowEq(this.props, props)) {\n    this.props = props;\n    this.flags |= C_DIRTY;\n  }\n};\n\nComponent.prototype.update = function() {\n  var flags = this.flags;\n\n  if ((flags & C_DIRTY) !== 0) {\n    var descriptor = this.descriptor;\n\n    if ((flags & C_UPDATE_HOOK) === 0) {\n      if ((flags & C_UPDATE_STATE_HOOK) !== 0) {\n        descriptor.updateState.call(this);\n        if (this.rev < this.state.rev) {\n          this.updateView(descriptor.build.call(this));\n        }\n      } else {\n        this.updateView(descriptor.build.call(this));\n      }\n      this.flags &= ~C_DIRTY;\n    } else {\n      descriptor.update.call(this);\n    }\n    this.rev = ENV.scheduler.clock;\n  }\n};\n\nComponent.prototype.updateView = function(newRoot) {\n  var root = this.root;\n\n  if (root == null) {\n    newRoot.ref = this.element;\n    newRoot.cref = this;\n    render(newRoot, this);\n  } else {\n    update(root, newRoot, this);\n  }\n  this.root = newRoot;\n};\n\nComponent.prototype.invalidate = function() {\n  if ((this.flags & C_DIRTY) === 0) {\n    this.flags |= C_DIRTY;\n    if (this._update == null) {\n      this._update = this.update.bind(this);\n    }\n\n    ENV.scheduler.nextFrame().write(this._update, this.depth);\n  }\n};\n\nComponent.prototype.dispose = function() {\n  if ((this.flags & C_STATEFUL) !== 0) {\n    this.state.dispose();\n  }\n};\n\nfunction injectComponent(component, parent) {\n  parent.appendChild(component.element);\n  component.attach();\n  component.update();\n};\n\nmodule.exports = {\n  VNode: VNode,\n  Component: Component,\n  declareComponent: declareComponent,\n  create: create,\n  render: render,\n  update: update,\n  createComponent: createComponent,\n  t: text,\n  $t: $text,\n  e: element,\n  $e: $element,\n  s: svg,\n  $s: $svg,\n  c: component,\n  $c: $component,\n  r: root,\n  injectComponent: injectComponent\n};\n\n},{\"./dnode\":2,\"./env\":3,\"./utils\":6}],8:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar vdom = kivi.vdom;\n\nvar Popover = require('./popover');\n\nfunction _formatElapsed(v) {\n  if (!v) return '';\n\n  var str = parseFloat(v).toFixed(2);\n\n  if (v > 60) {\n    var minutes = Math.floor(v / 60);\n    var comps = (value % 60).toFixed(2).split('.');\n    var seconds = comps[0].lpad('0', 2);\n    var ms = comps[1];\n    str = minutes + \":\" + seconds + \".\" + ms;\n  }\n\n  return str;\n}\n\nvar _IMPORTANT_CLASS = ['label-important'];\nvar _WARNING_CLASS = ['label-warning'];\nvar _SUCCESS_CLASS = ['label-success'];\n\nvar Entry = vdom.declareComponent({\n  flags: vdom.Component.DISABLE_PROPS_CHECK,\n\n  tag: 'tr',\n\n  build: function() {\n    var db = this.props.db;\n    var topFiveQueries = db.getTopFiveQueries();\n\n    var name = vdom.e('td');\n    name.type = 'dbname';\n    name.children = [vdom.t(db.name)];\n\n    var count = db.queries.length;\n\n    var qcSpan = vdom.e('span');\n    qcSpan.type = 'label';\n    qcSpan.children = [vdom.t(count)];\n    if (count >= 20) {\n      qcSpan.classes = _IMPORTANT_CLASS;\n    } else if (count >= 10) {\n      qcSpan.classes = _WARNING_CLASS;\n    } else {\n      qcSpan.classes = _SUCCESS_CLASS;\n    }\n\n    var qc = vdom.e('td');\n    qc.type = 'query-count';\n    qc.children = [qcSpan];\n\n    var children = [name, qc];\n\n    for (var i = 0; i < 5; i++) {\n      var q = topFiveQueries[i];\n      var elapsed = q.elapsed;\n      var text = vdom.t(_formatElapsed(elapsed));\n      var popover = vdom.c(Popover, {query: q.query});\n\n      var col = vdom.e('td');\n      col.type = 'Query';\n      var classes = [];\n      classes.push('elapsed');\n      if (elapsed >= 10.0) {\n        classes.push('warn_long');\n      } else if (elapsed >= 1.0) {\n        classes.push('warn');\n      } else {\n        classes.push('short');\n      }\n      col.classes = classes;\n      col.children = [text, popover];\n      children.push(col);\n    }\n\n    var root = vdom.r();\n    root.children = children;\n    return root;\n  }\n});\n\nmodule.exports = Entry;\n},{\"./popover\":10,\"kivi\":4}],9:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar vdom = kivi.vdom;\nvar Entry = require('./entry');\n\nvar _ROOT_CLASSES = ['table', 'table-striped', 'latest-data'];\n\nvar Main = vdom.declareComponent({\n  flags: vdom.Component.DISABLE_PROPS_CHECK,\n\n  tag: 'table',\n\n  build: function() {\n    var dbs = this.props.dbs;\n\n    var rows = [];\n    for (var i = 0; i < dbs.length; i++) {\n      var db = dbs[i];\n      rows.push(vdom.$c(db.id, Entry, {db: db}));\n    }\n\n    var tbody = vdom.e('tbody');\n    tbody.children = rows;\n\n    var root = vdom.r();\n    root.classes = _ROOT_CLASSES;\n    root.children = [tbody];\n\n    return root;\n  }\n});\n\nmodule.exports = Main;\n\n},{\"./entry\":8,\"kivi\":4}],10:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar vdom = kivi.vdom;\n\nvar _ROOT_CLASSES = ['popover', 'left'];\n\nvar Popover = vdom.declareComponent({\n  build: function() {\n    var content = vdom.e('div');\n    content.type = 'popover-content';\n    content.children = [vdom.t(this.props.query)];\n\n    var arrow = vdom.e('div');\n    arrow.type = 'arrow';\n\n    var root = vdom.r();\n    root.classes = _ROOT_CLASSES;\n    root.children = [content, arrow];\n\n    return root;\n  }\n});\n\nmodule.exports = Popover;\n\n},{\"kivi\":4}],11:[function(require,module,exports){\n'use strict';\n\nfunction Query(elapsed, waiting, query) {\n  this.elapsed = elapsed;\n  this.waiting = waiting;\n  this.query = query;\n}\n\nQuery.rand = function() {\n  var elapsed = Math.random() * 15;\n  var waiting = Math.random() < 0.5;\n  var query = 'SELECT blah FROM something';\n\n  if (Math.random() < 0.2) {\n    query = '<IDLE> in transaction';\n  }\n\n  if (Math.random() < 0.1) {\n    query = 'vacuum';\n  }\n\n  return new Query(elapsed, waiting, query);\n};\n\nvar _nextId = 0;\nfunction Database(name) {\n  this.id = _nextId++;\n  this.name = name;\n  this.queries = null;\n\n  this.update();\n}\n\nDatabase.prototype.update = function() {\n  var queries = [];\n\n  var r = Math.floor((Math.random() * 10) + 1);\n  for (var j = 0; j < r; j++) {\n    queries.push(Query.rand());\n  }\n\n  this.queries = queries;\n};\n\nDatabase.prototype.getTopFiveQueries = function() {\n  var qs = this.queries.slice();\n  qs.sort(function(a, b) {\n    return a.elapsed - b.elapsed;\n  });\n  qs = qs.slice(0, 5);\n  while (qs.length < 5) {\n    qs.push(new Query(0.0, false, ''));\n  }\n  return qs;\n};\n\nmodule.exports = {\n  Query: Query,\n  Database: Database\n};\n\n},{}]},{},[1]);\n"],"sourceRoot":"/source/"}