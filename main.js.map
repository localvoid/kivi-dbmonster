{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"update","dbs","I","N","kivi","Scheduler","data","Main","document","addEventListener","init","push","Database","main","vdom","createComponent","setInterval","invalidate","nextFrame","write","injectComponent","body","./component/main","./data","kivi/lib/scheduler",2,"module","DNode","this","dirty","rev","ENV","scheduler","dataClock","deps","subs","invalidated","ctx","_invalidate","node","create","prototype","reset","dSubs","indexOf","pop","sub","target","commit","./env",3,4,"scheduleMicrotask","cb","action","./dnode","./vdom",5,"_MutationObserverScheduler","_observer","window","MutationObserver","_node","createTextNode","observe","characterData","Frame","flags","writeTaskGroups","writeTasks","readTasks","afterTasks","clock","_actions","_microtasks","_currentFrame","_nextFrame","self","_microtaskScheduler","S_MICROTASK_PENDING","S_RUNNING","tasks","performActions","_handleAnimationFrame","frame","groups","group","task","j","S_FRAMETASK_PENDING","F_WRITE_ANY","F_WRITE_PRIO","F_WRITE","F_READ","F_AFTER","requestNextTick","_toggle","priority","read","after","currentFrame","requestAnimationFrame","actions",6,"VNode","key","tag","type","attrs","style","classes","children","ref","cref","text","content","V_TEXT","$text","element","V_ELEMENT","$element","customElement","V_CUSTOM_ELEMENT","$customElement","svg","V_SVG","$svg","component","descriptor","V_COMPONENT","$component","root","V_ROOT","sameType","b","context","createElement","createElementNS","render","il","nodeType","nodeAttrs","nodeStyle","nodeClasses","nodeChildren","classList","add","setAttribute","setProperty","insertChild","nodeValue","updateAttrs","updateStyle","updateClasses","updateChildren","E_UPDATE_HOOK","state","updateProps","aValue","bValue","removeAttribute","value","removeProperty","aItem","bItem","visited","removed","bIndex","remove","Array","parent","nextRef","C_INSERT_HOOK","insertBefore","insert","moveChild","C_MOVE_HOOK","move","removeChild","C_REMOVE_HOOK","aNode","bNode","unchangedPosition","updateImplicitChildren","updateExplicitChildren","nextPos","next","aStart","bStart","aEnd","bEnd","lastTarget","pos","aStartNode","bStartNode","aEndNode","bEndNode","stop","outer","aLength","bLength","sources","moved","removeOffset","keyIndex","seq","_lis","v","c","p","slice","result","declareElement","spec","E_INIT_HOOK","Component","props","C_DIRTY","depth","C_UPDATE_STATE_HOOK","_update","C_INIT_HOOK","declareComponent","updateState","build","attached","detached","domAttached","domDetached","C_UPDATE_PROPS_HOOK","C_STATEFUL","C_BUILD_HOOK","C_ATTACHED_HOOK","C_DETACHED_HOOK","C_DOM_ATTACHED_HOOK","C_DOM_DETACHED_HOOK","C_UPDATE_HOOK","appendChild","attach","domAttach","TEXT","ELEMENT","CUSTOM_ELEMENT","COMPONENT","ROOT","domDetach","detach","updateView","newRoot","bind","dispose","$t","$e","d","$d","$s","$c",7,"_formatElapsed","str","parseFloat","toFixed","minutes","Math","floor","comps","split","seconds","lpad","ms","Popover","_IMPORTANT_CLASS","_WARNING_CLASS","_SUCCESS_CLASS","Entry","db","topFiveQueries","getTopFiveQueries","name","count","queries","qcSpan","qc","q","elapsed","popover","query","col","./popover",8,"_ROOT_CLASSES","rows","id","tbody","./entry",9,"arrow",10,"Query","waiting","_nextId","rand","random","qs","sort"],"mappings":"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","file":"main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar I = 0;\nvar N = 100;\n\nvar kivi = require('kivi');\nvar Scheduler = require('kivi/lib/scheduler');\n\nvar data = require('./data');\nvar Main = require('./component/main');\n\nfunction update(dbs) {\n  for (var i = 0; i < dbs.length; i++) {\n    dbs[i].update();\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  kivi.init(new Scheduler());\n\n  var dbs = [];\n  for (var i = 0; i < N; i++) {\n    dbs.push(new data.Database('cluster' + i));\n    dbs.push(new data.Database('cluster' + i + 'slave'));\n  }\n\n  var main = kivi.vdom.createComponent(Main, {dbs: dbs});\n\n  setInterval(function() {\n    update(dbs);\n    main.invalidate();\n  }, I);\n\n  kivi.nextFrame().write(function() {\n    kivi.vdom.injectComponent(main, document.body);\n  });\n});\n\n},{\"./component/main\":8,\"./data\":10,\"kivi\":4,\"kivi/lib/scheduler\":5}],2:[function(require,module,exports){\n'use strict';\n\nvar ENV = require('./env');\n\nfunction DNode(data) {\n  if (data == null) {\n    this.dirty = true;\n    this.rev = -1;\n    this.data = null;\n  } else {\n    this.dirty = false;\n    this.rev = ENV.scheduler.dataClock;\n    this.data = data;\n  }\n  this.data = data;\n  this.deps = null;\n  this.subs = null;\n  this.invalidated = null;\n  this.ctx = null;\n}\n\nDNode.create = function(data) {\n  if (data === void 0) data = null;\n  return new DNode(data);\n};\n\nDNode.prototype.reset = function() {\n  var deps = this.deps;\n  if (deps != null) {\n    for (var i = 0; i < deps.length; i++) {\n      var dSubs = deps[i].subs;\n      dSubs[dSubs.indexOf(this)] = dSubs[dSubs.length - 1];\n      dSubs.pop();\n    }\n  }\n\n  this.deps = null;\n};\n\nDNode.prototype.sub = function(target) {\n  if (this.deps == null) {\n    this.deps = [];\n  }\n  this.deps.push(target);\n\n  if (target.subs == null) {\n    target.subs = [];\n  }\n  target.subs.push(this);\n};\n\nDNode.prototype.update = function(dirty) {\n  if (dirty) this.rev = ENV.scheduler.dataClock;\n  this.dirty = false;\n};\n\nDNode.prototype.commit = function() {\n  this.rev = ENV.scheduler.dataClock;\n\n  var subs = this.subs;\n  if (subs != null) {\n    for (var i = 0; i < subs.length; i++) {\n      _invalidate(subs[i]);\n    }\n  }\n};\n\nfunction _invalidate(node) {\n  if (!node.dirty) {\n    node.dirty = true;\n\n    if (node.invalidated != null) {\n      node.invalidated.call(node.ctx, node);\n    }\n\n    var subs = node.subs;\n    if (subs != null) {\n      for (var i = 0; i < subs.length; i++) {\n        _invalidate(subs[i]);\n      }\n    }\n\n    node.deps = null;\n    node.subs = null;\n  }\n}\n\nmodule.exports = DNode;\n\n},{\"./env\":3}],3:[function(require,module,exports){\n'use strict';\n\nvar ENV = {\n  scheduler: null\n};\n\nmodule.exports = ENV;\n\n},{}],4:[function(require,module,exports){\n'use strict';\n\nvar ENV = require('./env');\nvar DNode = require('./dnode');\nvar vdom = require('./vdom');\n\nfunction init(scheduler) {\n  ENV.scheduler = scheduler;\n}\n\nfunction nextFrame() {\n  return ENV.scheduler.nextFrame();\n}\n\nfunction scheduleMicrotask(cb) {\n  ENV.scheduler.scheduleMicrotask(cb);\n}\n\nfunction action(cb) {\n  ENV.scheduler.action(cb);\n}\n\nmodule.exports = {\n  ENV: ENV,\n  DNode: DNode,\n  vdom: vdom,\n  init: init,\n  nextFrame: nextFrame,\n  scheduleMicrotask: scheduleMicrotask,\n  action: action\n};\n\n},{\"./dnode\":2,\"./env\":3,\"./vdom\":6}],5:[function(require,module,exports){\n'use strict';\n\nfunction _MutationObserverScheduler(cb) {\n  this._observer = new window.MutationObserver(cb);\n  this._node = document.createTextNode('');\n  this._observer.observe(this._node, {characterData: true});\n}\n\n_MutationObserverScheduler.prototype.requestNextTick = function() {\n  this._toggle ^= 1;\n  this._node.data = this._toggle;\n};\n\nvar F_WRITE_PRIO = 4;\nvar F_WRITE = 8;\nvar F_READ = 16;\nvar F_AFTER = 32;\nvar F_WRITE_ANY = F_WRITE | F_WRITE_PRIO;\n\nfunction Frame() {\n  this.flags = 0|0;\n  this.writeTaskGroups = [];\n  this.writeTasks = null;\n  this.readTasks = null;\n  this.afterTasks = null;\n}\n\nFrame.prototype.write = function(cb, priority) {\n  var group;\n\n  if (priority === void 0) priority = -1;\n\n  if (priority === -1) {\n    this.flags |= F_WRITE;\n    if (this.writeTasks == null) {\n      this.writeTasks = [];\n    }\n    this.writeTasks.push(cb);\n  } else {\n    this.flags |= F_WRITE_PRIO;\n    while (priority >= this.writeTaskGroups.length) {\n      this.writeTaskGroups.push(null);\n    }\n\n    group = this.writeTaskGroups[priority];\n    if (group == null) {\n      group = this.writeTaskGroups[priority] = [];\n    }\n\n    group.push(cb);\n  }\n};\n\nFrame.prototype.read = function(cb) {\n  this.flags |= F_READ;\n  if (this.readTasks == null) {\n    this.readTasks = [];\n  }\n  this.readTasks.push(cb);\n};\n\nFrame.prototype.after = function(cb) {\n  this.flags |= F_AFTER;\n  if (this.afterTasks == null) {\n    this.afterTasks = [];\n  }\n  this.afterTasks.push(cb);\n};\n\nvar S_RUNNING = 1;\nvar S_MICROTASK_PENDING = 2;\nvar S_FRAMETASK_PENDING = 4;\n\nfunction Scheduler() {\n  this.flags = 0|0;\n  this.dataClock = 0;\n  this.clock = -1;\n\n  this._actions = null;\n\n  this._microtasks = null;\n  this._currentFrame = new Frame();\n  this._nextFrame = new Frame();\n\n  var self = this;\n\n  this._microtaskScheduler = new _MutationObserverScheduler(function() {\n    self.flags &= ~S_MICROTASK_PENDING;\n    self.flags |= S_RUNNING;\n    self.clock++;\n\n    var tasks = self._microtasks;\n    if (tasks != null) {\n      self._microtasks = null;\n\n      for (var i = 0; i < tasks.length; i++) {\n        tasks[i]();\n      }\n    }\n\n    self.dataClock++;\n    self.performActions();\n    self.flags &= ~S_RUNNING;\n  });\n\n  this._handleAnimationFrame = function() {\n    var frame;\n    var groups;\n    var group;\n    var task;\n    var i, j;\n\n    self.flags &= ~S_FRAMETASK_PENDING;\n    self.flags |= S_RUNNING;\n    self.clock++;\n\n    frame = self._nextFrame;\n    self._nextFrame = self._currentFrame;\n    self._currentFrame = frame;\n\n    do {\n      while ((frame.flags & F_WRITE_ANY) !== 0) {\n        if ((frame.flags & F_WRITE_PRIO) !== 0) {\n          frame.flags &= ~F_WRITE_PRIO;\n          groups = frame.writeTaskGroups;\n\n          for (i = 0; i < groups.length; i++) {\n            group = groups[i];\n            if (group != null) {\n              groups[i] = null;\n              for (j = 0; j < group.length; j++) {\n                task = group[j];\n                task();\n              }\n            }\n          }\n        }\n\n        if ((frame.flags & F_WRITE) !== 0) {\n          frame.flags &= ~F_WRITE;\n          group = frame.writeTasks;\n          for (i = 0; i < group.length; i++) {\n            task = group[i];\n            task();\n          }\n        }\n      }\n\n      while ((frame.flags & F_READ) !== 0) {\n        frame.flags &= ~F_READ;\n        group = frame.readTasks;\n        frame.readTasks = null;\n\n        for (i = 0; i < group.length; i++) {\n          task = group[i];\n          task();\n        }\n      }\n    } while ((frame.flags & F_WRITE_ANY) !== 0);\n\n    while ((frame.flags & F_AFTER) !== 0) {\n      frame.flags &= ~F_AFTER;\n\n      group = frame.afterTasks;\n      for (i = 0; i < group.length; i++) {\n        task = group[i];\n        task();\n      }\n    }\n\n    self.dataClock++;\n    self.performActions();\n    self.flags &= ~S_RUNNING;\n  };\n};\n\nScheduler.prototype.currentFrame = function() {\n  return this._currentFrame;\n};\n\nScheduler.prototype.nextFrame = function() {\n  if ((this.flags & S_FRAMETASK_PENDING) === 0) {\n    this.flags |= S_FRAMETASK_PENDING;\n    window.requestAnimationFrame(this._handleAnimationFrame);\n  }\n  return this._nextFrame;\n};\n\nScheduler.prototype.scheduleMicrotask = function(cb) {\n  if ((this.flags & S_MICROTASK_PENDING) === 0) {\n    this.flags |= S_MICROTASK_PENDING;\n    this._microtaskScheduler.requestNextTick();\n  }\n\n  if (this._microtasks == null) {\n    this._microtasks = [];\n  }\n\n  this._microtasks.push(cb);\n};\n\nScheduler.prototype.action = function(cb) {\n  if ((this.flags & S_MICROTASK_PENDING) === 0) {\n    this.flags |= S_MICROTASK_PENDING;\n    this._microtaskScheduler.requestNextTick();\n  }\n\n  if (this._actions == null) {\n    this._actions = [];\n  }\n\n  this._actions.push(cb);\n};\n\nScheduler.prototype.performActions = function() {\n  while (this._actions != null) {\n    var actions = this._actions;\n    this._actions = null;\n    for (var i = 0; i < actions.length; i++) {\n      actions[i]();\n    }\n  }\n};\n\nmodule.exports = Scheduler;\n\n},{}],6:[function(require,module,exports){\n'use strict';\n\nvar DNode = require('./dnode');\nvar ENV = require('./env');\n\nvar V_TEXT = 1;\nvar V_ELEMENT = 2;\nvar V_CUSTOM_ELEMENT = 4;\nvar V_COMPONENT = 8;\nvar V_ROOT = 16;\nvar V_SVG = 64;\n\n/**\n * Virtual Node.\n *\n * @param flags Flags.\n * @param key Key that should be unique among its siblings. If the key\n *   is null, it means that the key is implicit.\n * @param tag When the VNode is Element tag represents its tagName,\n *   and when VNode is a Component it is a ComponentFactory.\n * @param data\n * @constructor\n */\nfunction VNode(flags, key, tag, data) {\n  this.flags = flags;\n  this.key = key;\n  this.tag = tag;\n  this.data = data;\n  this.type = null;\n  this.attrs = null;\n  this.style = null;\n  this.classes = null;\n  this.children = null;\n  this.ref = null;\n  this.cref = null;\n}\n\nVNode.TEXT = V_TEXT;\nVNode.ELEMENT = V_ELEMENT;\nVNode.CUSTOM_ELEMENT = V_CUSTOM_ELEMENT;\nVNode.COMPONENT = V_COMPONENT;\nVNode.ROOT = V_ROOT;\n\nfunction text(content) {\n  return new VNode(V_TEXT, null, null, content);\n};\n\nfunction $text(key, content) {\n  return new VNode(V_TEXT, key, null, content);\n};\n\nfunction element(tag) {\n  return new VNode(V_ELEMENT, null, tag, null);\n};\n\nfunction $element(key, tag) {\n  return new VNode(V_ELEMENT, key, tag, null);\n};\n\nfunction customElement(tag, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_CUSTOM_ELEMENT, null, tag, data);\n};\n\nfunction $customElement(key, tag, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_ELEMENT, key, tag, data);\n};\n\nfunction svg(tag) {\n  return new VNode(V_ELEMENT | V_SVG, null, tag, null);\n};\n\nfunction $svg(key, tag) {\n  return new VNode(V_ELEMENT | V_SVG, key, tag, null);\n};\n\nfunction component(descriptor, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_COMPONENT, null, descriptor, data);\n};\n\nfunction $component(key, descriptor, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_COMPONENT, key, descriptor, data);\n};\n\nfunction root() {\n  return new VNode(V_ROOT, null, null, null);\n};\n\n/**\n * Checks if two VNodes have the same type and they can be updated.\n */\nfunction sameType(a, b) {\n  return (a.flags === b.flags && a.tag === b.tag);\n}\n\n/**\n * Create internal state of the VNode.\n */\nfunction create(node, context) {\n  var flags = node.flags;\n\n  if ((flags & V_TEXT) !== 0) {\n    node.ref = document.createTextNode(node.data);\n  } else if ((flags & V_ELEMENT) !== 0) {\n    if ((flags & V_SVG) === 0) {\n      node.ref = document.createElement(node.tag);\n    } else {\n      node.ref = document.createElementNS('http://www.w3.org/2000/svg', node.tag);\n    }\n  } else if ((flags & V_CUSTOM_ELEMENT) !== 0) {\n    node.ref = createElement(node.tag, node.data);\n  } else if ((flags & V_COMPONENT) !== 0) {\n    var component = createComponent(node.tag, node.data, context);\n    node.ref = component.element;\n    node.cref = component;\n  }\n};\n\n/**\n * Render internal representation of the VNode.\n */\nfunction render(node, context) {\n  var i, il;\n  var key;\n  var flags = node.flags;\n\n  if ((flags & (V_ELEMENT | V_CUSTOM_ELEMENT | V_COMPONENT | V_ROOT)) !== 0) {\n    var ref = node.ref;\n    var nodeType = node.type;\n    var nodeAttrs = node.attrs;\n    var nodeStyle = node.style;\n    var nodeClasses = node.classes;\n    var nodeChildren = node.children;\n\n    if (nodeType != null) {\n      ref.classList.add(nodeType);\n    }\n\n    if (nodeAttrs != null) {\n      for (key in nodeAttrs) {\n        ref.setAttribute(key, nodeAttrs[key]);\n      }\n    }\n\n    if (nodeStyle != null) {\n      var style = ref.style;\n\n      for (key in nodeStyle) {\n        style.setProperty(key, nodeStyle[key]);\n      }\n    }\n\n    if (nodeClasses != null) {\n      var classList = ref.classList;\n\n      for (i = 0, il = nodeClasses.length; i < il; i++) {\n        classList.add(nodeClasses[i]);\n      }\n    }\n\n    if (nodeChildren != null) {\n      for (i = 0, il = nodeChildren.length; i < il; i++) {\n        insertChild(node, nodeChildren[i], null, context);\n      }\n    }\n\n    if ((flags & V_COMPONENT) !== 0) {\n      node.cref.update();\n    }\n  }\n};\n\n/**\n * Update VNode. When VNode a is updated with VNode b, VNode a should\n * be considered as destroyed, and any access to it is an undefined\n * behaviour.\n *\n * @param {!VNode} a Old VNode\n * @param {!VNode} b New VNode\n * @param {Context} context\n */\nfunction update(a, b, context) {\n  var ref = a.ref;\n  var flags = a.flags;\n  b.ref = ref;\n\n  if ((flags & V_TEXT) !== 0) {\n    if (a.data != b.data) {\n      a.ref.nodeValue = b.data; // nodeValue\n    }\n\n  } else if ((flags & (V_ELEMENT | V_CUSTOM_ELEMENT | V_COMPONENT | V_ROOT)) !== 0) {\n    // No need to update type class, because it should be immutable.\n\n    if (a.attrs !== b.attrs) {\n      updateAttrs(a.attrs, b.attrs, ref);\n    }\n    if (a.style !== b.style) {\n      updateStyle(a.style, b.style, ref.style);\n    }\n    if (a.classes !== b.classes) {\n      updateClasses(a.classes, b.classes, ref.classList);\n    }\n    if (a.children !== b.children) {\n      updateChildren(a, a.children, b.children, context);\n    }\n\n    if ((flags & V_CUSTOM_ELEMENT) !== 0) {\n      var descriptor = b.tag;\n      if ((descriptor.flags & E_UPDATE_HOOK) !== 0) {\n        descriptor.update.call(ref, a.data, b.data);\n      }\n    } else if ((flags & V_COMPONENT) !== 0) {\n      var component = b.cref = a.cref;\n      var state = component.state;\n\n      component.updateProps(b.data);\n      component.update();\n    }\n  }\n};\n\n/**\n * Update HTMLElement attributes.\n *\n * @param a Old attributes.\n * @param b New attributes.\n * @param attributes\n */\nfunction updateAttrs(a, b, node) {\n  var key;\n  var aValue;\n  var bValue;\n\n  if (a != null) {\n    if (b == null) {\n      // b is empty, remove all attributes from a.\n      for (key in a) {\n        node.removeAttribute(key);\n      }\n    } else {\n      // Remove and update attributes.\n      for (key in a) {\n        bValue = b[key];\n        if (bValue === void 0) {\n          node.removeAttribute(key);\n        } else {\n          aValue = a[key];\n          if (aValue !== bValue) {\n            node.setAttribute(key, bValue);\n          }\n        }\n      }\n\n      // Insert new attributes.\n      for (key in b) {\n        aValue = a[key];\n        if (aValue === void 0) {\n          node.setAttribute(key, b[key]);\n        }\n      }\n    }\n  } else if (b != null) {\n    // a is empty, insert all attributes from b.\n    for (key in b) {\n      node.setAttribute(key, b[key]);\n    }\n  }\n}\n\n/**\n * Update HTMLElement styles.\n *\n * @param {Object.<string,string>} a Old style.\n * @param {Object.<string,string>} b New style.\n * @param {CSSStyleDeclaration} style\n */\nfunction updateStyle(a, b, style) {\n  var key;\n  var value;\n\n  if (a != null) {\n    if (b == null) {\n      // b is empty, remove all styles from a.\n      for (key in a) {\n        style.removeProperty(key);\n      }\n    } else {\n      // Remove and update styles.\n      for (key in a) {\n        value = b[key];\n        if (value === void 0) {\n          style.removeProperty(key);\n        } else {\n          style.setProperty(key, value);\n        }\n      }\n\n      // Insert new styles.\n      for (key in b) {\n        value = a[key];\n        if (value === void 0) {\n          style.setProperty(key, b[key]);\n        }\n      }\n    }\n  } else if (b != null) {\n    // a is empty, insert all styles from b.\n    for (key in b) {\n      style.setProperty(key, b[key]);\n    }\n  }\n}\n\n/**\n * Update HTMLElement classes.\n *\n * @param {Array.<string>} a Old classes.\n * @param {Array.<string>} b New classes.\n * @param {DOMTokenList} classList\n */\nfunction updateClasses(a, b, classList) {\n  var i;\n  var j;\n  var key;\n  var aItem;\n  var bItem;\n  var visited;\n  var removed;\n  var bIndex;\n\n  if (a != null && a.length > 0) {\n    if (b == null || b.length === 0) {\n      // b is empty, remove all classes from a.\n      for (i = 0; i < a.length; i++) {\n        classList.remove(a[i]);\n      }\n    } else {\n      // When lists a and b are small, we are using naive O(M*N) algorithm\n      // to find differences.\n      if (a.length * b.length <= 16) {\n        visited = new Array(b.length);\n\n        for (i = 0; i < a.length; i++) {\n          aItem = a[i];\n          removed = true;\n\n          for (j = 0; j < b.length; j++) {\n            bItem = b[j];\n\n            if (aItem === bItem) {\n              removed = false;\n              visited[j] = true;\n              break;\n            }\n          }\n\n          if (removed) {\n            classList.remove(aItem);\n          }\n        }\n\n        for (i = 0; i < b.length; i++) {\n          if (visited[i] != true) {\n            classList.add(b[i]);\n          }\n        }\n      } else {\n        bIndex = {};\n\n        for (i = 0; i < b.length; i++) {\n          bItem = b[i];\n          bIndex[bItem] = false;\n        }\n\n        for (i = 0; i < a.length; i++) {\n          aItem = a[i];\n          if (bIndex[aItem] === void 0) {\n            classList.remove(aItem);\n          } else {\n            bIndex[aItem] = true;\n          }\n        }\n\n        for (key in bIndex) {\n          if (bIndex[key] === false) {\n            classList.add(key);\n          }\n        }\n      }\n    }\n  } else if (b != null && b.length > 0) {\n    // a is empty, insert all classes from b.\n    for (i = 0; i < b.length; i++) {\n      classList.add(b[i]);\n    }\n  }\n}\n\n/**\n * Insert VNode.\n *\n * @param {VNode} parent Parent node.\n * @param {VNode} node Node to insert.\n * @param {HTMLElement} b Reference to the next html element.\n * @param {Context} context Current context.\n */\nfunction insertChild(parent, node, nextRef, context) {\n  if (((parent.flags & V_COMPONENT) === 0) ||\n      ((parent.cref.flags & C_INSERT_HOOK) === 0)) {\n    create(node, context);\n    parent.ref.insertBefore(node.ref, nextRef);\n    render(node, context);\n  } else {\n    parent.cref.descriptor.insert.call(parent.cref, node, nextRef, context);\n  }\n}\n\n/**\n * Move VNode.\n *\n * @param {VNode} parent Parent node.\n * @param {VNode} node Node to move.\n * @param {HTMLElement} b Reference to the next html element.\n * @param {Context} context Current context.\n */\nfunction moveChild(parent, node, nextRef, context) {\n  if (((parent.flags & V_COMPONENT) === 0) ||\n      ((parent.cref.flags & C_MOVE_HOOK) === 0)) {\n    parent.ref.insertBefore(node.ref, nextRef);\n  } else {\n    parent.cref.descriptor.move.call(parent.cref, node, nextRef, context);\n  }\n}\n\n/**\n * Remove VNode.\n *\n * @param {VNode} parent Parent node.\n * @param {VNode} node Node to remove.\n * @param {Context} context Current context.\n */\nfunction removeChild(parent, node, context) {\n  if (((parent.flags & V_COMPONENT) === 0) ||\n      ((parent.cref.flags & C_REMOVE_HOOK) === 0)) {\n    parent.ref.removeChild(node.ref);\n  } else {\n    parent.cref.descriptor.remove.call(parent.cref, node, context);\n  }\n}\n\n/**\n * Update childrens [a] and [b] in the [parent].\n *\n * If one of the childrens has `null` `key`, it will run update\n * algorithm for childrens with implicit keys, otherwise it will run\n * update algorithm for childrens with explicit keys.\n *\n * Mixing childrens with explicit and implicit keys in one children\n * list will result in undefined behaviour. In development mode it\n * will be checked for this conditions and if it is detected that\n * there are childrens with implicit and explicit keys, it will result\n * in runtime error.\n *\n * @param {VNode} parent Childrens parent.\n * @param {Array.<VNode>} a Old children list.\n * @param {Array.<VNode>} b New children list.\n * @param {Context} context Current context.\n */\nfunction updateChildren(parent, a, b, context) {\n  var aNode;\n  var bNode;\n  var i;\n  var unchangedPosition;\n\n  if (a != null && a.length !== 0) {\n    if (b == null || b.length === 0) {\n      // b is empty, remove all children from a.\n      for (i = 0; i < a.length; i++) {\n        removeChild(parent, a[i], context);\n      }\n    } else {\n      if (a.length === 1 && b.length === 1) {\n        // Fast path when a and b have only one child.\n        aNode = a[0];\n        bNode = b[0];\n\n        // Implicit key with same type or explicit key with same key.\n        if ((aNode.key == null && sameType(aNode, bNode)) ||\n            (aNode.key != null && aNode.key === bNode.key)) {\n          update(aNode, bNode, context);\n        } else {\n          removeChild(parent, aNode, context);\n          insertChild(parent, bNode, null, context);\n        }\n      } else if (a.length === 1) {\n        // Fast path when a have 1 child.\n        aNode = a[0];\n        if (aNode.key == null) {\n          updateImplicitChildren(parent, a, b, context);\n        } else {\n          unchangedPosition = -1;\n          for (i = 0; i < b.length; i++) {\n            bNode = b[i];\n            if (aNode.key === bNode.key) {\n              unchangedPosition = i;\n              break;\n            } else {\n              insertChild(parent, bNode, aNode.ref, context);\n            }\n          }\n          if (unchangedPosition !== -1) {\n            for (i = unchangedPosition + 1; i < b.length; i++) {\n              insertChild(parent, b[i], null, context);\n            }\n            update(aNode, b[unchangedPosition], context);\n          } else {\n            removeChild(parent, aNode, context);\n          }\n        }\n      } else if (b.length === 1) {\n        // Fast path when b have 1 child.\n        bNode = b[0];\n        if (bNode.key == null) {\n          updateImplicitChildren(parent, a, b, context);\n        } else {\n          unchangedPosition = -1;\n          for (i = 0; i < a.length; i++) {\n            aNode = a[i];\n            if (aNode.key === bNode.key) {\n              unchangedPosition = i;\n              break;\n            } else {\n              removeChild(parent, aNode, context);\n            }\n          }\n          if (unchangedPosition !== -1) {\n            for (i = unchangedPosition + 1; i < a.length; i++) {\n              removeChild(parent, a[i], context);\n            }\n            update(a[unchangedPosition], bNode, context);\n          } else {\n            insertChild(parent, bNode, null, context);\n          }\n        }\n      } else {\n        // a and b have more than 1 child.\n        if (a[0].key == null) {\n          updateImplicitChildren(parent, a, b, context);\n        } else {\n          updateExplicitChildren(parent, a, b, context);\n        }\n      }\n    }\n  } else if (b != null && b.length > 0) {\n    // a is empty, insert all children from b\n    for (i = 0; i < b.length; i++) {\n      insertChild(parent, b[i], null, context);\n    }\n  }\n}\n\n/**\n * Update childrens with implicit keys `a` and `b` in the `parent`.\n *\n * Any heuristics that is used in this algorithm is an undefined\n * behaviour, and external dependencies should not relay on the\n * knowledge about this algorithm, because it can be changed in any\n * time.\n *\n * @param {VNode} parent Childrens parent.\n * @param {Array.<VNode>} a Old children list.\n * @param {Array.<VNode>} b New children list.\n * @param {Context} context Current context.\n */\nfunction updateImplicitChildren(parent, a, b, context) {\n  var aStart = 0;\n  var bStart = 0;\n  var aEnd = a.length - 1;\n  var bEnd = b.length - 1;\n  var aNode;\n  var bNode;\n  var nextPos;\n  var next;\n\n  // Update nodes with the same type at the beginning.\n  while (aStart <= aEnd && bStart <= bEnd) {\n    aNode = a[aStart];\n    bNode = b[bStart];\n\n    if (!sameType(aNode, bNode)) {\n      break;\n    }\n\n    aStart++;\n    bStart++;\n\n    update(aNode, bNode, context);\n  }\n\n  // Update nodes with the same type at the end.\n  while (aStart <= aEnd && bStart <= bEnd) {\n    aNode = a[aEnd];\n    bNode = b[bEnd];\n\n    if (!sameType(aNode, bNode)) {\n      break;\n    }\n\n    aEnd--;\n    bEnd--;\n\n    update(aNode, bNode, context);\n  }\n\n  // Iterate through the remaining nodes and if they have the same\n  // type, then update, otherwise just remove the old node and insert\n  // the new one.\n  while (aStart <= aEnd && bStart <= bEnd) {\n    aNode = a[aStart++];\n    bNode = b[bStart++];\n    if (sameType(aNode, bNode)) {\n      update(aNode, bNode, context);\n    } else {\n      insertChild(parent, bNode, aNode.ref, context);\n      removeChild(parent, aNode, context);\n    }\n  }\n\n  // All nodes from a are updated, insert the rest from b.\n  while (aStart <= aEnd) {\n    removeChild(parent, a[aStart++], context);\n  }\n\n  nextPos = bEnd + 1;\n  next = nextPos < b.length ? b[nextPos].ref : null;\n\n  // All nodes from b are updated, remove the rest from a.\n  while (bStart <= bEnd) {\n    insertChild(parent, b[bStart++], next, context);\n  }\n}\n\n/**\n * Update childrens with explicit keys [a] and [b] in the [parent].\n *\n * @param {VNode} parent Childrens parent.\n * @param {Array.<VNode>} a Old children list.\n * @param {Array.<VNode>} b New children list.\n * @param {Context} context Current context.\n */\nfunction updateExplicitChildren(parent, a, b, context) {\n  var aStart = 0;\n  var bStart = 0;\n  var aEnd = a.length - 1;\n  var bEnd = b.length - 1;\n  var aStartNode = a[aStart];\n  var bStartNode = b[bStart];\n  var aEndNode = a[aEnd];\n  var bEndNode = b[bEnd];\n  var i;\n  var j;\n  var stop = false;\n  var nextPos;\n  var next;\n  var aNode;\n  var bNode;\n  var lastTarget;\n  var pos;\n  var node;\n\n  // Algorithm that works on simple cases with basic list\n  // transformations.\n  //\n  // It tries to reduce the diff problem by simultaneously iterating\n  // from the beginning and the end of both lists, if keys are the\n  // same, they're updated, if node is moved from the beginnin to the\n  // end of the current cursor positions or vice versa it just\n  // performs move operation and continues to reduce the diff problem.\n  outer: do {\n    stop = true;\n\n    // Update nodes with the same key at the beginning.\n    while (aStartNode.key === bStartNode.key) {\n      update(aStartNode, bStartNode, context);\n      aStart++;\n      bStart++;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aStartNode = a[aStart];\n      bStartNode = b[bStart];\n      stop = false;\n    }\n\n    // Update nodes with the same key at the end.\n    while (aEndNode.key === bEndNode.key) {\n      update(aEndNode, bEndNode, context);\n      aEnd--;\n      bEnd--;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aEndNode = a[aEnd];\n      bEndNode = b[bEnd];\n      stop = false;\n    }\n\n    // Move nodes from left to right.\n    while (aStartNode.key === bEndNode.key) {\n      update(aStartNode, bEndNode, context);\n      nextPos = bEnd + 1;\n      next = nextPos < b.length ? b[nextPos].ref : null;\n      moveChild(parent, bEndNode, next, context);\n      aStart++;\n      bEnd--;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aStartNode = a[aStart];\n      bEndNode = b[bEnd];\n      stop = false;\n      continue outer;\n    }\n\n    // Move nodes from right to left.\n    while (aEndNode.key === bStartNode.key) {\n      update(aEndNode, bStartNode, context);\n      moveChild(parent, bStartNode, aStartNode.ref, context);\n      aEnd--;\n      bStart++;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aEndNode = a[aEnd];\n      bStartNode = b[bStart];\n      stop = false;\n    }\n  } while (!stop && aStart <= aEnd && bStart <= bEnd);\n\n  if (aStart > aEnd) {\n    // All nodes from a are updated, insert the rest from b.\n    nextPos = bEnd + 1;\n    next = nextPos < b.length ? b[nextPos].ref : null;\n    while (bStart <= bEnd) {\n      insertChild(parent, b[bStart++], next, context);\n    }\n  } else if (bStart > bEnd) {\n    // All nodes from b are updated, remove the rest from a.\n    while (aStart <= aEnd) {\n      removeChild(parent, a[aStart++], context);\n    }\n  } else {\n    // Perform more complex update algorithm on the remaining nodes.\n    //\n    // We start by marking all nodes from b as inserted, then we try\n    // to find all removed nodes and simultaneously perform updates on\n    // the nodes that exists in both lists and replacing \"inserted\"\n    // marks with the position of the node from the list b in list a.\n    // Then we just need to perform slightly modified LIS algorith,\n    // that ignores \"inserted\" marks and find common subsequence and\n    // move all nodes that doesn't belong to this subsequence, or\n    // insert if they have \"inserted\" mark.\n    var aLength = aEnd - aStart + 1;\n    var bLength = bEnd - bStart + 1;\n    var sources = new Array(bLength);\n\n    // Mark all nodes as inserted.\n    for (i = 0; i < bLength; i++) {\n      sources[i] = -1;\n    }\n\n    var moved = false;\n    var removeOffset = 0;\n\n    // When lists a and b are small, we are using naive O(M*N) algorithm\n    // to find removed children.\n    if (aLength * bLength <= 16) {\n      for (i = aStart; i <= aEnd; i++) {\n        var removed = true;\n        aNode = a[i];\n        for (j = bStart; j <= bEnd; j++) {\n          bNode = b[j];\n          if (aNode.key === bNode.key) {\n            sources[j - bStart] = i;\n\n            if (lastTarget > j) {\n              moved = true;\n            } else {\n              lastTarget = j;\n            }\n            update(aNode, bNode, context);\n            removed = false;\n            break;\n          }\n        }\n        if (removed) {\n          removeChild(parent, aNode, context);\n          removeOffset++;\n        }\n      }\n    } else {\n      var keyIndex = {};\n\n      for (i = bStart; i <= bEnd; i++) {\n        node = b[i];\n        keyIndex[node.key] = i;\n      }\n\n      for (i = aStart; i <= aEnd; i++) {\n        aNode = a[i];\n        j = keyIndex[aNode.key];\n\n        if (j != null) {\n          bNode = b[j];\n          sources[j - bStart] = i;\n          if (lastTarget > j) {\n            moved = true;\n          } else {\n            lastTarget = j;\n          }\n          update(aNode, bNode, context);\n        } else {\n          removeChild(parent, aNode, context);\n          removeOffset++;\n        }\n      }\n    }\n\n    if (moved) {\n      var seq = _lis(sources);\n      // All modifications are performed from the right to left, so we\n      // can use insertBefore method and use reference to the html\n      // element from the next VNode. All Nodes from the right side\n      // should always be in the correct state.\n      j = seq.length - 1;\n      for (i = bLength - 1; i >= 0; i--) {\n        if (sources[i] === -1) {\n          pos = i + bStart;\n          node = b[pos];\n          nextPos = pos + 1;\n          next = nextPos < b.length ? b[nextPos].ref : null;\n          insertChild(parent, node, next, context);\n        } else {\n          if (j < 0 || i != seq[j]) {\n            pos = i + bStart;\n            node = b[pos];\n            nextPos = pos + 1;\n            next = nextPos < b.length ? b[nextPos].ref : null;\n            moveChild(parent, node, next, context);\n          } else {\n            j--;\n          }\n        }\n      }\n    } else if (aLength - removeOffset != bLength) {\n      for (i = bLength - 1; i >= 0; i--) {\n        if (sources[i] === -1) {\n          pos = i + bStart;\n          node = b[pos];\n          nextPos = pos + 1;\n          next = nextPos < b.length ? b[nextPos].ref : null;\n          insertChild(parent, node, next, context);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Slightly modified Longest Increased Subsequence algorithm, it\n * ignores items that have -1 value. They're representing new items.\n *\n * This algorithm is used to find minimum number of move operations\n * when updating childrens with explicit keys.\n *\n * http://en.wikipedia.org/wiki/Longest_increasing_subsequence\n *\n * @param {Array.<number>} a\n * @return {Array.<number>}\n */\nfunction _lis(a) {\n  var p = a.slice(0);\n  var result = [0];\n  var i, il;\n  var j;\n  var u;\n  var v;\n  var c;\n\n  for (i = 0, il = a.length; i < il; i++) {\n    if (a[i] === -1) {\n      continue;\n    }\n\n    j = result[result.length - 1];\n    if (a[j] < a[i]) {\n      p[i] = j;\n      result.push(i);\n      continue;\n    }\n\n    u = 0;\n    v = result.length - 1;\n\n    while (u < v) {\n      c = ((u + v) / 2) | 0;\n      if (a[result[c]] < a[i]) {\n        u = c + 1;\n      } else {\n        v = c;\n      }\n    }\n\n    if (a[i] < a[result[u]]) {\n      if (u > 0) {\n        p[i] = result[u - 1];\n      }\n      result[u] = i;\n    }\n  }\n\n  u = result.length;\n  v = result[u - 1];\n\n  while (u-- > 0) {\n    result[u] = v;\n    v = p[v];\n  }\n\n  return result;\n}\n\n/**\n * Custom Elements\n */\nvar E_INIT_HOOK = 4;\nvar E_UPDATE_HOOK = 8;\n\nfunction declareElement(spec) {\n  var flags = 0;\n  var tag = spec.tag;\n  var init = spec.init;\n  var update = spec.update;\n\n  if (tag === void 0) tag = 'div';\n\n  if (init === void 0) init = null;\n  else flags |= E_INIT_HOOK;\n\n  if (update === void 0) update = null;\n  else flags |= E_UPDATE_HOOK;\n\n  return {\n    flags: flags,\n    tag: tag,\n    init: init,\n    update: update\n  };\n}\n\nfunction createElement(descriptor, data) {\n  var e = document.createElement(descriptor.tag);\n  if ((descriptor.flags & E_INIT_HOOK) !== 0) {\n    descriptor.init.call(e, data);\n  }\n  return e;\n}\n\nfunction updateElement(element, descriptor, oldData, newData) {\n  if ((descriptor.flags & E_UPDATE_HOOK) !== 0) {\n    descriptor.update.call(element, oldData, newData);\n  }\n}\n\n/**\n * Components\n */\nvar C_DIRTY = 1;\nvar C_STATEFUL = 2;\nvar C_DOM_ATTACHED = 4;\nvar C_RENDERED = 8;\nvar C_MOUNTED = 16;\nvar C_UPDATE_PROPS_HOOK = 128;\nvar C_UPDATE_STATE_HOOK = 256;\nvar C_INIT_HOOK = 512;\nvar C_BUILD_HOOK = 1024;\nvar C_ATTACHED_HOOK = 2048;\nvar C_DETACHED_HOOK = 4096;\nvar C_DOM_ATTACHED_HOOK = 8192;\nvar C_DOM_DETACHED_HOOK = 16384;\nvar C_UPDATE_HOOK = 65536;\nvar C_INSERT_HOOK = 262144;\nvar C_MOVE_HOOK = 524288;\nvar C_REMOVE_HOOK = 1048576;\n\n/**\n * Component.\n *\n * @param {!Object} descriptor Component descriptor object.\n * @param {!Component} parent Parent component.\n * @param {Object} data Component data.\n * @final\n * @constructor\n * @struct\n */\nfunction Component(descriptor, parent, props) {\n  var flags = descriptor.flags;\n\n  /**\n   * Component flags.\n   * @type {number}\n   */\n  this.flags = flags | C_DIRTY;\n\n  /**\n   * ComponentDescriptor.\n   * @type {!Object}\n   */\n  this.descriptor = descriptor;\n\n  /**\n   * Depth relative to other Components.\n   * @type {number}\n   */\n  this.depth = parent == null ? 0 : parent.depth + 1;\n\n  /**\n   * Parent Component.\n   * @type {Component}\n   */\n  this.parent = parent;\n\n  this.props = props;\n\n  /**\n   * Component State.\n   * @type {!DNode}\n   */\n  if ((flags & C_UPDATE_STATE_HOOK) === 0) {\n    this.state = null;\n  } else {\n    this.state = DNode.create();\n    this.state.invalidated = this.invalidate;\n    this.state.ctx = this;\n  }\n\n  this.rev = -1;\n\n  /**\n   * Root node in the Components virtual tree.\n   * @type {VNode}\n   */\n  this.root = null;\n\n  /**\n   * Reference to the Html Element.\n   * @type {HTMLElement}\n   */\n  this.element = document.createElement(descriptor.tag);\n\n  /**\n   * updateLater bound method.\n   * @type {function(this:!Component)}\n   */\n  this._update = null;\n\n  if ((flags & C_INIT_HOOK) !== 0) {\n    descriptor.init.call(this);\n  }\n}\n\n/**\n * Create Component Descriptor Object\n * @nosideeffects\n * @param {!Object} decl Component declaration\n * @return {!Object}\n */\nfunction declareComponent(spec) {\n  var flags = 0|0;\n  var tag = spec.tag;\n  var updateProps = spec.updateProps;\n  var updateState = spec.updateState;\n  var init = spec.init;\n  var build = spec.build;\n  var attached = spec.attached;\n  var detached = spec.detached;\n  var domAttached = spec.domAttached;\n  var domDetached = spec.domDetached;\n  var update = spec.update;\n  var insert = spec.insert;\n  var move = spec.move;\n  var remove = spec.remove;\n\n  if (tag === void 0) tag = 'div';\n\n  if (updateProps === void 0) updateProps = null;\n  else flags |= C_UPDATE_PROPS_HOOK;\n\n  if (updateState === void 0) updateState = null;\n  else flags |= C_STATEFUL | C_UPDATE_STATE_HOOK;\n\n  if (init === void 0) init = null;\n  else flags |= C_INIT_HOOK;\n\n  if (build === void 0) build = null;\n  else flags |= C_BUILD_HOOK;\n\n  if (attached === void 0) attached = null;\n  else flags |= C_ATTACHED_HOOK;\n\n  if (detached === void 0) detached = null;\n  else flags |= C_DETACHED_HOOK;\n\n  if (domAttached === void 0) domAttached = null;\n  else flags |= C_DOM_ATTACHED_HOOK;\n\n  if (domDetached === void 0) domDetached = null;\n  else flags |= C_DOM_DETACHED_HOOK;\n\n  if (update === void 0) update = null;\n  else flags |= C_UPDATE_HOOK;\n\n  if (insert === void 0) insert = null;\n  else flags |= C_INSERT_HOOK;\n\n  if (move === void 0) move = null;\n  else flags |= C_MOVE_HOOK;\n\n  if (remove === void 0) remove = null;\n  else flags |= C_REMOVE_HOOK;\n\n  return {\n    flags: flags,\n    updateProps: updateProps,\n    updateState: updateState,\n    init: init,\n    build: build,\n    attached: attached,\n    detached: detached,\n    domAttached: domAttached,\n    domDetached: domDetached,\n    update: update,\n    insert: insert,\n    move: move,\n    remove: remove,\n    tag: tag\n  };\n};\n\nfunction createComponent(descriptor, props, ctx) {\n  return new Component(descriptor, ctx, props);\n};\n\nComponent.prototype.domAttach = function() {};\nComponent.prototype.domDetach = function() {};\nComponent.prototype.attach = function() {};\nComponent.prototype.detach = function() {};\n\nComponent.prototype.updateProps = function(props) {\n  if ((this.flags & C_UPDATE_PROPS_HOOK) !== 0) {\n    if (this.descriptor.updateProps.call(this, props)) {\n      this.flags |= C_DIRTY;\n    }\n  } else {\n    // TODO: shallow equal check by default\n    this.props = props;\n    this.flags |= C_DIRTY;\n  }\n};\n\nComponent.prototype.update = function() {\n  var flags = this.flags;\n\n  if ((flags & C_DIRTY) !== 0) {\n    var descriptor = this.descriptor;\n\n    if ((flags & C_UPDATE_HOOK) === 0) {\n      if ((flags & C_UPDATE_STATE_HOOK) !== 0) {\n        descriptor.updateState.call(this);\n        if (this.rev < this.state.rev) {\n          this.updateView(descriptor.build.call(this));\n        }\n      } else {\n        this.updateView(descriptor.build.call(this));\n      }\n      this.flags &= ~C_DIRTY;\n    } else {\n      descriptor.update.call(this);\n    }\n    this.rev = ENV.scheduler.clock;\n  }\n};\n\nComponent.prototype.updateView = function(newRoot) {\n  var root = this.root;\n\n  if (root == null) {\n    newRoot.ref = this.element;\n    newRoot.cref = this;\n    render(newRoot, this);\n  } else {\n    update(root, newRoot, this);\n  }\n  this.root = newRoot;\n};\n\nComponent.prototype.invalidate = function() {\n  if ((this.flags & C_DIRTY) === 0) {\n    this.flags |= C_DIRTY;\n    if (this._update == null) {\n      this._update = this.update.bind(this);\n    }\n\n    ENV.scheduler.nextFrame().write(this._update, this.depth);\n  }\n};\n\nComponent.prototype.dispose = function() {\n  if ((this.flags & C_STATEFUL) !== 0) {\n    this.state.dispose();\n  }\n};\n\nfunction injectComponent(component, parent) {\n  parent.appendChild(component.element);\n  component.attach();\n  component.domAttach();\n  component.update();\n};\n\nmodule.exports = {\n  VNode: VNode,\n  Component: Component,\n  declareElement: declareElement,\n  declareComponent: declareComponent,\n  create: create,\n  render: render,\n  update: update,\n  createComponent: createComponent,\n  t: text,\n  $t: $text,\n  e: element,\n  $e: $element,\n  d: customElement,\n  $d: $customElement,\n  s: svg,\n  $s: $svg,\n  c: component,\n  $c: $component,\n  r: root,\n  injectComponent: injectComponent\n};\n\n},{\"./dnode\":2,\"./env\":3}],7:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar vdom = kivi.vdom;\n\nvar Popover = require('./popover');\n\nfunction _formatElapsed(v) {\n  if (!v) return '';\n\n  var str = parseFloat(v).toFixed(2);\n\n  if (v > 60) {\n    var minutes = Math.floor(v / 60);\n    var comps = (value % 60).toFixed(2).split('.');\n    var seconds = comps[0].lpad('0', 2);\n    var ms = comps[1];\n    str = minutes + \":\" + seconds + \".\" + ms;\n  }\n\n  return str;\n}\n\nvar _IMPORTANT_CLASS = ['label-important'];\nvar _WARNING_CLASS = ['label-warning'];\nvar _SUCCESS_CLASS = ['label-success'];\n\nvar Entry = vdom.declareComponent({\n  tag: 'tr',\n\n  build: function() {\n    var db = this.props.db;\n    var topFiveQueries = db.getTopFiveQueries();\n\n    var name = vdom.e('td');\n    name.type = 'dbname';\n    name.children = [vdom.t(db.name)];\n\n    var count = db.queries.length;\n\n    var qcSpan = vdom.e('span');\n    qcSpan.type = 'label';\n    qcSpan.children = [vdom.t(count)];\n    if (count >= 20) {\n      qcSpan.classes = _IMPORTANT_CLASS;\n    } else if (count >= 10) {\n      qcSpan.classes = _WARNING_CLASS;\n    } else {\n      qcSpan.classes = _SUCCESS_CLASS;\n    }\n\n    var qc = vdom.e('td');\n    qc.type = 'query-count';\n    qc.children = [qcSpan];\n\n    var children = [name, qc];\n\n    for (var i = 0; i < 5; i++) {\n      var q = topFiveQueries[i];\n      var elapsed = q.elapsed;\n      var text = vdom.t(_formatElapsed(elapsed));\n      var popover = vdom.c(Popover, {query: q.query});\n\n      var col = vdom.e('td');\n      col.type = 'Query';\n      var classes = [];\n      classes.push('elapsed');\n      if (elapsed >= 10.0) {\n        classes.push('warn_long');\n      } else if (elapsed >= 1.0) {\n        classes.push('warn');\n      } else {\n        classes.push('short');\n      }\n      col.classes = classes;\n      col.children = [text, popover];\n      children.push(col);\n    }\n\n    var root = vdom.r();\n    root.children = children;\n    return root;\n  }\n});\n\nmodule.exports = Entry;\n},{\"./popover\":9,\"kivi\":4}],8:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar vdom = kivi.vdom;\nvar Entry = require('./entry');\n\nvar _ROOT_CLASSES = ['table', 'table-striped', 'latest-data'];\n\nvar Main = vdom.declareComponent({\n  tag: 'table',\n\n  build: function() {\n    var dbs = this.props.dbs;\n\n    var rows = [];\n    for (var i = 0; i < dbs.length; i++) {\n      var db = dbs[i];\n      rows.push(vdom.$c(db.id, Entry, {db: db}));\n    }\n\n    var tbody = vdom.e('tbody');\n    tbody.children = rows;\n\n    var root = vdom.r();\n    root.classes = _ROOT_CLASSES;\n    root.children = [tbody];\n\n    return root;\n  }\n});\n\nmodule.exports = Main;\n\n},{\"./entry\":7,\"kivi\":4}],9:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar vdom = kivi.vdom;\n\nvar _ROOT_CLASSES = ['popover', 'left'];\n\nvar Popover = vdom.declareComponent({\n  build: function() {\n    var content = vdom.e('div');\n    content.type = 'popover-content';\n    content.children = [vdom.t(this.props.query)];\n\n    var arrow = vdom.e('div');\n    arrow.type = 'arrow';\n\n    var root = vdom.r();\n    root.classes = _ROOT_CLASSES;\n    root.children = [content, arrow];\n\n    return root;\n  }\n});\n\nmodule.exports = Popover;\n\n},{\"kivi\":4}],10:[function(require,module,exports){\n'use strict';\n\nfunction Query(elapsed, waiting, query) {\n  this.elapsed = elapsed;\n  this.waiting = waiting;\n  this.query = query;\n}\n\nQuery.rand = function() {\n  var elapsed = Math.random() * 15;\n  var waiting = Math.random() < 0.5;\n  var query = 'SELECT blah FROM something';\n\n  if (Math.random() < 0.2) {\n    query = '<IDLE> in transaction';\n  }\n\n  if (Math.random() < 0.1) {\n    query = 'vacuum';\n  }\n\n  return new Query(elapsed, waiting, query);\n};\n\nvar _nextId = 0;\nfunction Database(name) {\n  this.id = _nextId++;\n  this.name = name;\n  this.queries = null;\n\n  this.update();\n}\n\nDatabase.prototype.update = function() {\n  var queries = [];\n\n  var r = Math.floor((Math.random() * 10) + 1);\n  for (var j = 0; j < r; j++) {\n    queries.push(Query.rand());\n  }\n\n  this.queries = queries;\n};\n\nDatabase.prototype.getTopFiveQueries = function() {\n  var qs = this.queries.slice();\n  qs.sort(function(a, b) {\n    return a.elapsed - b.elapsed;\n  });\n  qs = qs.slice(0, 5);\n  while (qs.length < 5) {\n    qs.push(new Query(0.0, false, ''));\n  }\n  return qs;\n};\n\nmodule.exports = {\n  Query: Query,\n  Database: Database\n};\n\n},{}]},{},[1]);\n"],"sourceRoot":"/source/"}