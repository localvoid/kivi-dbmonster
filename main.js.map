{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"INTERVAL","DATABASE_COUNT","kivi","Scheduler","app","Store","Cache","Main","document","addEventListener","init","store","cache","setInterval","action","update","nextFrame","write","vdom","injectComponent","createComponent","body","./app","./cache","./component/main","./store","kivi/lib/scheduler",2,"module","DNode","data","this","dirty","rev","ENV","scheduler","dataClock","deps","subs","invalidated","ctx","_invalidate","node","create","prototype","reset","dSubs","indexOf","pop","sub","target","push","commit","./env",3,4,"scheduleMicrotask","cb","./dnode","./vdom",5,"_MutationObserverScheduler","_observer","window","MutationObserver","_node","createTextNode","observe","characterData","Frame","flags","writeTaskGroups","writeTasks","readTasks","afterTasks","clock","_actions","_microtasks","_currentFrame","_nextFrame","self","_microtaskScheduler","S_MICROTASK_PENDING","S_RUNNING","tasks","performActions","_handleAnimationFrame","frame","groups","group","task","j","S_FRAMETASK_PENDING","F_WRITE_ANY","F_WRITE_PRIO","F_WRITE","F_READ","F_AFTER","requestNextTick","_toggle","priority","read","after","currentFrame","requestAnimationFrame","actions",6,"VNode","key","tag","type","attrs","style","classes","children","ref","cref","text","content","V_TEXT","$text","element","V_ELEMENT","$element","customElement","V_CUSTOM_ELEMENT","$customElement","svg","V_SVG","$svg","component","descriptor","V_COMPONENT","$component","root","V_ROOT","sameType","b","context","createElement","createElementNS","render","il","nodeType","nodeAttrs","nodeStyle","nodeClasses","nodeChildren","classList","add","setAttribute","setProperty","insertChild","nodeValue","updateAttrs","updateStyle","updateClasses","updateChildren","E_UPDATE_HOOK","state","updateProps","aValue","bValue","removeAttribute","value","removeProperty","aItem","bItem","visited","removed","bIndex","remove","Array","parent","nextRef","C_INSERT_HOOK","insertBefore","insert","moveChild","C_MOVE_HOOK","move","removeChild","C_REMOVE_HOOK","aNode","bNode","unchangedPosition","updateImplicitChildren","updateExplicitChildren","nextPos","next","aStart","bStart","aEnd","bEnd","lastTarget","pos","aStartNode","bStartNode","aEndNode","bEndNode","stop","outer","aLength","bLength","sources","moved","removeOffset","keyIndex","seq","_lis","v","c","p","slice","result","declareElement","spec","E_INIT_HOOK","Component","props","C_DIRTY","depth","C_UPDATE_STATE_HOOK","invalidate","_update","C_INIT_HOOK","declareComponent","updateState","build","attached","detached","domAttached","domDetached","C_UPDATE_PROPS_HOOK","C_STATEFUL","C_BUILD_HOOK","C_ATTACHED_HOOK","C_DETACHED_HOOK","C_DOM_ATTACHED_HOOK","C_DOM_DETACHED_HOOK","C_UPDATE_HOOK","appendChild","attach","domAttach","TEXT","ELEMENT","CUSTOM_ELEMENT","COMPONENT","ROOT","domDetach","detach","updateView","newRoot","bind","dispose","$t","$e","d","$d","$s","$c",7,8,"DatabaseCache","_queries","getTopFiveQueries","id","qs","db","get","queries","sort","elapsed","query","waiting",9,"_formatElapsed","str","parseFloat","toFixed","minutes","Math","floor","comps","split","seconds","lpad","ms","Popover","_IMPORTANT_CLASS","_WARNING_CLASS","_SUCCESS_CLASS","Entry","topFiveQueries","name","count","qcSpan","qc","q","popover","col","../app","./popover",10,"_ROOT_CLASSES","dbs","getAll","rows","tbody","./entry",11,"arrow",12,"DatabaseStore","_nextId","_dbs","random"],"mappings":"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","file":"main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar INTERVAL = 0;\nvar DATABASE_COUNT = 100;\n\nvar kivi = require('kivi');\nvar Scheduler = require('kivi/lib/scheduler');\n\nvar app = require('./app');\nvar Store = require('./store');\nvar Cache = require('./cache');\nvar Main = require('./component/main');\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  kivi.init(new Scheduler());\n\n  app.store = new Store(DATABASE_COUNT);\n  app.cache = new Cache();\n\n  setInterval(function() {\n    kivi.action(function() {\n      app.store.update();\n    });\n  }, INTERVAL);\n\n  kivi.nextFrame().write(function() {\n    kivi.vdom.injectComponent(kivi.vdom.createComponent(Main), document.body);\n  });\n});\n},{\"./app\":7,\"./cache\":8,\"./component/main\":10,\"./store\":12,\"kivi\":4,\"kivi/lib/scheduler\":5}],2:[function(require,module,exports){\n'use strict';\n\nvar ENV = require('./env');\n\nfunction DNode(data) {\n  if (data == null) {\n    this.dirty = true;\n    this.rev = -1;\n    this.data = null;\n  } else {\n    this.dirty = false;\n    this.rev = ENV.scheduler.dataClock;\n    this.data = data;\n  }\n  this.data = data;\n  this.deps = null;\n  this.subs = null;\n  this.invalidated = null;\n  this.ctx = null;\n}\n\nDNode.create = function(data) {\n  if (data === void 0) data = null;\n  return new DNode(data);\n};\n\nDNode.prototype.reset = function() {\n  var deps = this.deps;\n  if (deps != null) {\n    for (var i = 0; i < deps.length; i++) {\n      var dSubs = deps[i].subs;\n      dSubs[dSubs.indexOf(this)] = dSubs[dSubs.length - 1];\n      dSubs.pop();\n    }\n  }\n\n  this.deps = null;\n};\n\nDNode.prototype.sub = function(target) {\n  if (this.deps == null) {\n    this.deps = [];\n  }\n  this.deps.push(target);\n\n  if (target.subs == null) {\n    target.subs = [];\n  }\n  target.subs.push(this);\n};\n\nDNode.prototype.update = function(dirty) {\n  if (dirty) this.rev = ENV.scheduler.dataClock;\n  this.dirty = false;\n};\n\nDNode.prototype.commit = function() {\n  this.rev = ENV.scheduler.dataClock;\n\n  var subs = this.subs;\n  if (subs != null) {\n    for (var i = 0; i < subs.length; i++) {\n      _invalidate(subs[i]);\n    }\n  }\n};\n\nfunction _invalidate(node) {\n  if (!node.dirty) {\n    node.dirty = true;\n\n    if (node.invalidated != null) {\n      node.invalidated.call(node.ctx, node);\n    }\n\n    var subs = node.subs;\n    if (subs != null) {\n      for (var i = 0; i < subs.length; i++) {\n        _invalidate(subs[i]);\n      }\n    }\n\n    node.deps = null;\n    node.subs = null;\n  }\n}\n\nmodule.exports = DNode;\n\n},{\"./env\":3}],3:[function(require,module,exports){\n'use strict';\n\nvar ENV = {\n  scheduler: null\n};\n\nmodule.exports = ENV;\n\n},{}],4:[function(require,module,exports){\n'use strict';\n\nvar ENV = require('./env');\nvar DNode = require('./dnode');\nvar vdom = require('./vdom');\n\nfunction init(scheduler) {\n  ENV.scheduler = scheduler;\n}\n\nfunction nextFrame() {\n  return ENV.scheduler.nextFrame();\n}\n\nfunction scheduleMicrotask(cb) {\n  ENV.scheduler.scheduleMicrotask(cb);\n}\n\nfunction action(cb) {\n  ENV.scheduler.action(cb);\n}\n\nmodule.exports = {\n  ENV: ENV,\n  DNode: DNode,\n  vdom: vdom,\n  init: init,\n  nextFrame: nextFrame,\n  scheduleMicrotask: scheduleMicrotask,\n  action: action\n};\n\n},{\"./dnode\":2,\"./env\":3,\"./vdom\":6}],5:[function(require,module,exports){\n'use strict';\n\nfunction _MutationObserverScheduler(cb) {\n  this._observer = new window.MutationObserver(cb);\n  this._node = document.createTextNode('');\n  this._observer.observe(this._node, {characterData: true});\n}\n\n_MutationObserverScheduler.prototype.requestNextTick = function() {\n  this._toggle ^= 1;\n  this._node.data = this._toggle;\n};\n\nvar F_WRITE_PRIO = 4;\nvar F_WRITE = 8;\nvar F_READ = 16;\nvar F_AFTER = 32;\nvar F_WRITE_ANY = F_WRITE | F_WRITE_PRIO;\n\nfunction Frame() {\n  this.flags = 0|0;\n  this.writeTaskGroups = [];\n  this.writeTasks = null;\n  this.readTasks = null;\n  this.afterTasks = null;\n}\n\nFrame.prototype.write = function(cb, priority) {\n  var group;\n\n  if (priority === void 0) priority = -1;\n\n  if (priority === -1) {\n    this.flags |= F_WRITE;\n    if (this.writeTasks == null) {\n      this.writeTasks = [];\n    }\n    this.writeTasks.push(cb);\n  } else {\n    this.flags |= F_WRITE_PRIO;\n    while (priority >= this.writeTaskGroups.length) {\n      this.writeTaskGroups.push(null);\n    }\n\n    group = this.writeTaskGroups[priority];\n    if (group == null) {\n      group = this.writeTaskGroups[priority] = [];\n    }\n\n    group.push(cb);\n  }\n};\n\nFrame.prototype.read = function(cb) {\n  this.flags |= F_READ;\n  if (this.readTasks == null) {\n    this.readTasks = [];\n  }\n  this.readTasks.push(cb);\n};\n\nFrame.prototype.after = function(cb) {\n  this.flags |= F_AFTER;\n  if (this.afterTasks == null) {\n    this.afterTasks = [];\n  }\n  this.afterTasks.push(cb);\n};\n\nvar S_RUNNING = 1;\nvar S_MICROTASK_PENDING = 2;\nvar S_FRAMETASK_PENDING = 4;\n\nfunction Scheduler() {\n  this.flags = 0|0;\n  this.dataClock = 0;\n  this.clock = -1;\n\n  this._actions = null;\n\n  this._microtasks = null;\n  this._currentFrame = new Frame();\n  this._nextFrame = new Frame();\n\n  var self = this;\n\n  this._microtaskScheduler = new _MutationObserverScheduler(function() {\n    self.flags &= ~S_MICROTASK_PENDING;\n    self.flags |= S_RUNNING;\n    self.clock++;\n\n    var tasks = self._microtasks;\n    if (tasks != null) {\n      self._microtasks = null;\n\n      for (var i = 0; i < tasks.length; i++) {\n        tasks[i]();\n      }\n    }\n\n    self.dataClock++;\n    self.performActions();\n    self.flags &= ~S_RUNNING;\n  });\n\n  this._handleAnimationFrame = function() {\n    var frame;\n    var groups;\n    var group;\n    var task;\n    var i, j;\n\n    self.flags &= ~S_FRAMETASK_PENDING;\n    self.flags |= S_RUNNING;\n    self.clock++;\n\n    frame = self._nextFrame;\n    self._nextFrame = self._currentFrame;\n    self._currentFrame = frame;\n\n    do {\n      while ((frame.flags & F_WRITE_ANY) !== 0) {\n        if ((frame.flags & F_WRITE_PRIO) !== 0) {\n          frame.flags &= ~F_WRITE_PRIO;\n          groups = frame.writeTaskGroups;\n\n          for (i = 0; i < groups.length; i++) {\n            group = groups[i];\n            if (group != null) {\n              groups[i] = null;\n              for (j = 0; j < group.length; j++) {\n                task = group[j];\n                task();\n              }\n            }\n          }\n        }\n\n        if ((frame.flags & F_WRITE) !== 0) {\n          frame.flags &= ~F_WRITE;\n          group = frame.writeTasks;\n          for (i = 0; i < group.length; i++) {\n            task = group[i];\n            task();\n          }\n        }\n      }\n\n      while ((frame.flags & F_READ) !== 0) {\n        frame.flags &= ~F_READ;\n        group = frame.readTasks;\n        frame.readTasks = null;\n\n        for (i = 0; i < group.length; i++) {\n          task = group[i];\n          task();\n        }\n      }\n    } while ((frame.flags & F_WRITE_ANY) !== 0);\n\n    while ((frame.flags & F_AFTER) !== 0) {\n      frame.flags &= ~F_AFTER;\n\n      group = frame.afterTasks;\n      for (i = 0; i < group.length; i++) {\n        task = group[i];\n        task();\n      }\n    }\n\n    self.dataClock++;\n    self.performActions();\n    self.flags &= ~S_RUNNING;\n  };\n};\n\nScheduler.prototype.currentFrame = function() {\n  return this._currentFrame;\n};\n\nScheduler.prototype.nextFrame = function() {\n  if ((this.flags & S_FRAMETASK_PENDING) === 0) {\n    this.flags |= S_FRAMETASK_PENDING;\n    window.requestAnimationFrame(this._handleAnimationFrame);\n  }\n  return this._nextFrame;\n};\n\nScheduler.prototype.scheduleMicrotask = function(cb) {\n  if ((this.flags & S_MICROTASK_PENDING) === 0) {\n    this.flags |= S_MICROTASK_PENDING;\n    this._microtaskScheduler.requestNextTick();\n  }\n\n  if (this._microtasks == null) {\n    this._microtasks = [];\n  }\n\n  this._microtasks.push(cb);\n};\n\nScheduler.prototype.action = function(cb) {\n  if ((this.flags & S_MICROTASK_PENDING) === 0) {\n    this.flags |= S_MICROTASK_PENDING;\n    this._microtaskScheduler.requestNextTick();\n  }\n\n  if (this._actions == null) {\n    this._actions = [];\n  }\n\n  this._actions.push(cb);\n};\n\nScheduler.prototype.performActions = function() {\n  while (this._actions != null) {\n    var actions = this._actions;\n    this._actions = null;\n    for (var i = 0; i < actions.length; i++) {\n      actions[i]();\n    }\n  }\n};\n\nmodule.exports = Scheduler;\n\n},{}],6:[function(require,module,exports){\n'use strict';\n\nvar DNode = require('./dnode');\nvar ENV = require('./env');\n\nvar V_TEXT = 1;\nvar V_ELEMENT = 2;\nvar V_CUSTOM_ELEMENT = 4;\nvar V_COMPONENT = 8;\nvar V_ROOT = 16;\nvar V_SVG = 64;\n\n/**\n * Virtual Node.\n *\n * @param flags Flags.\n * @param key Key that should be unique among its siblings. If the key\n *   is null, it means that the key is implicit.\n * @param tag When the VNode is Element tag represents its tagName,\n *   and when VNode is a Component it is a ComponentFactory.\n * @param data\n * @constructor\n */\nfunction VNode(flags, key, tag, data) {\n  this.flags = flags;\n  this.key = key;\n  this.tag = tag;\n  this.data = data;\n  this.type = null;\n  this.attrs = null;\n  this.style = null;\n  this.classes = null;\n  this.children = null;\n  this.ref = null;\n  this.cref = null;\n}\n\nVNode.TEXT = V_TEXT;\nVNode.ELEMENT = V_ELEMENT;\nVNode.CUSTOM_ELEMENT = V_CUSTOM_ELEMENT;\nVNode.COMPONENT = V_COMPONENT;\nVNode.ROOT = V_ROOT;\n\nfunction text(content) {\n  return new VNode(V_TEXT, null, null, content);\n};\n\nfunction $text(key, content) {\n  return new VNode(V_TEXT, key, null, content);\n};\n\nfunction element(tag) {\n  return new VNode(V_ELEMENT, null, tag, null);\n};\n\nfunction $element(key, tag) {\n  return new VNode(V_ELEMENT, key, tag, null);\n};\n\nfunction customElement(tag, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_CUSTOM_ELEMENT, null, tag, data);\n};\n\nfunction $customElement(key, tag, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_ELEMENT, key, tag, data);\n};\n\nfunction svg(tag) {\n  return new VNode(V_ELEMENT | V_SVG, null, tag, null);\n};\n\nfunction $svg(key, tag) {\n  return new VNode(V_ELEMENT | V_SVG, key, tag, null);\n};\n\nfunction component(descriptor, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_COMPONENT, null, descriptor, data);\n};\n\nfunction $component(key, descriptor, data) {\n  if (data === void 0) data = null;\n  return new VNode(V_COMPONENT, key, descriptor, data);\n};\n\nfunction root() {\n  return new VNode(V_ROOT, null, null, null);\n};\n\n/**\n * Checks if two VNodes have the same type and they can be updated.\n */\nfunction sameType(a, b) {\n  return (a.flags === b.flags && a.tag === b.tag);\n}\n\n/**\n * Create internal state of the VNode.\n */\nfunction create(node, context) {\n  var flags = node.flags;\n\n  if ((flags & V_TEXT) !== 0) {\n    node.ref = document.createTextNode(node.data);\n  } else if ((flags & V_ELEMENT) !== 0) {\n    if ((flags & V_SVG) === 0) {\n      node.ref = document.createElement(node.tag);\n    } else {\n      node.ref = document.createElementNS('http://www.w3.org/2000/svg', node.tag);\n    }\n  } else if ((flags & V_CUSTOM_ELEMENT) !== 0) {\n    node.ref = createElement(node.tag, node.data);\n  } else if ((flags & V_COMPONENT) !== 0) {\n    var component = createComponent(node.tag, node.data, context);\n    node.ref = component.element;\n    node.cref = component;\n  }\n};\n\n/**\n * Render internal representation of the VNode.\n */\nfunction render(node, context) {\n  var i, il;\n  var key;\n  var flags = node.flags;\n\n  if ((flags & (V_ELEMENT | V_CUSTOM_ELEMENT | V_COMPONENT | V_ROOT)) !== 0) {\n    var ref = node.ref;\n    var nodeType = node.type;\n    var nodeAttrs = node.attrs;\n    var nodeStyle = node.style;\n    var nodeClasses = node.classes;\n    var nodeChildren = node.children;\n\n    if (nodeType != null) {\n      ref.classList.add(nodeType);\n    }\n\n    if (nodeAttrs != null) {\n      for (key in nodeAttrs) {\n        ref.setAttribute(key, nodeAttrs[key]);\n      }\n    }\n\n    if (nodeStyle != null) {\n      var style = ref.style;\n\n      for (key in nodeStyle) {\n        style.setProperty(key, nodeStyle[key]);\n      }\n    }\n\n    if (nodeClasses != null) {\n      var classList = ref.classList;\n\n      for (i = 0, il = nodeClasses.length; i < il; i++) {\n        classList.add(nodeClasses[i]);\n      }\n    }\n\n    if (nodeChildren != null) {\n      for (i = 0, il = nodeChildren.length; i < il; i++) {\n        insertChild(node, nodeChildren[i], null, context);\n      }\n    }\n\n    if ((flags & V_COMPONENT) !== 0) {\n      node.cref.update();\n    }\n  }\n};\n\n/**\n * Update VNode. When VNode a is updated with VNode b, VNode a should\n * be considered as destroyed, and any access to it is an undefined\n * behaviour.\n *\n * @param {!VNode} a Old VNode\n * @param {!VNode} b New VNode\n * @param {Context} context\n */\nfunction update(a, b, context) {\n  var ref = a.ref;\n  var flags = a.flags;\n  b.ref = ref;\n\n  if ((flags & V_TEXT) !== 0) {\n    if (a.data != b.data) {\n      a.ref.nodeValue = b.data; // nodeValue\n    }\n\n  } else if ((flags & (V_ELEMENT | V_CUSTOM_ELEMENT | V_COMPONENT | V_ROOT)) !== 0) {\n    // No need to update type class, because it should be immutable.\n\n    if (a.attrs !== b.attrs) {\n      updateAttrs(a.attrs, b.attrs, ref);\n    }\n    if (a.style !== b.style) {\n      updateStyle(a.style, b.style, ref.style);\n    }\n    if (a.classes !== b.classes) {\n      updateClasses(a.classes, b.classes, ref.classList);\n    }\n    if (a.children !== b.children) {\n      updateChildren(a, a.children, b.children, context);\n    }\n\n    if ((flags & V_CUSTOM_ELEMENT) !== 0) {\n      var descriptor = b.tag;\n      if ((descriptor.flags & E_UPDATE_HOOK) !== 0) {\n        descriptor.update.call(ref, a.data, b.data);\n      }\n    } else if ((flags & V_COMPONENT) !== 0) {\n      var component = b.cref = a.cref;\n      var state = component.state;\n\n      component.updateProps(b.data);\n      component.update();\n    }\n  }\n};\n\n/**\n * Update HTMLElement attributes.\n *\n * @param a Old attributes.\n * @param b New attributes.\n * @param attributes\n */\nfunction updateAttrs(a, b, node) {\n  var key;\n  var aValue;\n  var bValue;\n\n  if (a != null) {\n    if (b == null) {\n      // b is empty, remove all attributes from a.\n      for (key in a) {\n        node.removeAttribute(key);\n      }\n    } else {\n      // Remove and update attributes.\n      for (key in a) {\n        bValue = b[key];\n        if (bValue === void 0) {\n          node.removeAttribute(key);\n        } else {\n          aValue = a[key];\n          if (aValue !== bValue) {\n            node.setAttribute(key, bValue);\n          }\n        }\n      }\n\n      // Insert new attributes.\n      for (key in b) {\n        aValue = a[key];\n        if (aValue === void 0) {\n          node.setAttribute(key, b[key]);\n        }\n      }\n    }\n  } else if (b != null) {\n    // a is empty, insert all attributes from b.\n    for (key in b) {\n      node.setAttribute(key, b[key]);\n    }\n  }\n}\n\n/**\n * Update HTMLElement styles.\n *\n * @param {Object.<string,string>} a Old style.\n * @param {Object.<string,string>} b New style.\n * @param {CSSStyleDeclaration} style\n */\nfunction updateStyle(a, b, style) {\n  var key;\n  var value;\n\n  if (a != null) {\n    if (b == null) {\n      // b is empty, remove all styles from a.\n      for (key in a) {\n        style.removeProperty(key);\n      }\n    } else {\n      // Remove and update styles.\n      for (key in a) {\n        value = b[key];\n        if (value === void 0) {\n          style.removeProperty(key);\n        } else {\n          style.setProperty(key, value);\n        }\n      }\n\n      // Insert new styles.\n      for (key in b) {\n        value = a[key];\n        if (value === void 0) {\n          style.setProperty(key, b[key]);\n        }\n      }\n    }\n  } else if (b != null) {\n    // a is empty, insert all styles from b.\n    for (key in b) {\n      style.setProperty(key, b[key]);\n    }\n  }\n}\n\n/**\n * Update HTMLElement classes.\n *\n * @param {Array.<string>} a Old classes.\n * @param {Array.<string>} b New classes.\n * @param {DOMTokenList} classList\n */\nfunction updateClasses(a, b, classList) {\n  var i;\n  var j;\n  var key;\n  var aItem;\n  var bItem;\n  var visited;\n  var removed;\n  var bIndex;\n\n  if (a != null && a.length > 0) {\n    if (b == null || b.length === 0) {\n      // b is empty, remove all classes from a.\n      for (i = 0; i < a.length; i++) {\n        classList.remove(a[i]);\n      }\n    } else {\n      // When lists a and b are small, we are using naive O(M*N) algorithm\n      // to find differences.\n      if (a.length * b.length <= 16) {\n        visited = new Array(b.length);\n\n        for (i = 0; i < a.length; i++) {\n          aItem = a[i];\n          removed = true;\n\n          for (j = 0; j < b.length; j++) {\n            bItem = b[j];\n\n            if (aItem === bItem) {\n              removed = false;\n              visited[j] = true;\n              break;\n            }\n          }\n\n          if (removed) {\n            classList.remove(aItem);\n          }\n        }\n\n        for (i = 0; i < b.length; i++) {\n          if (visited[i] != true) {\n            classList.add(b[i]);\n          }\n        }\n      } else {\n        bIndex = {};\n\n        for (i = 0; i < b.length; i++) {\n          bItem = b[i];\n          bIndex[bItem] = false;\n        }\n\n        for (i = 0; i < a.length; i++) {\n          aItem = a[i];\n          if (bIndex[aItem] === void 0) {\n            classList.remove(aItem);\n          } else {\n            bIndex[aItem] = true;\n          }\n        }\n\n        for (key in bIndex) {\n          if (bIndex[key] === false) {\n            classList.add(key);\n          }\n        }\n      }\n    }\n  } else if (b != null && b.length > 0) {\n    // a is empty, insert all classes from b.\n    for (i = 0; i < b.length; i++) {\n      classList.add(b[i]);\n    }\n  }\n}\n\n/**\n * Insert VNode.\n *\n * @param {VNode} parent Parent node.\n * @param {VNode} node Node to insert.\n * @param {HTMLElement} b Reference to the next html element.\n * @param {Context} context Current context.\n */\nfunction insertChild(parent, node, nextRef, context) {\n  if (((parent.flags & V_COMPONENT) === 0) ||\n      ((parent.cref.flags & C_INSERT_HOOK) === 0)) {\n    create(node, context);\n    parent.ref.insertBefore(node.ref, nextRef);\n    render(node, context);\n  } else {\n    parent.cref.descriptor.insert.call(parent.cref, node, nextRef, context);\n  }\n}\n\n/**\n * Move VNode.\n *\n * @param {VNode} parent Parent node.\n * @param {VNode} node Node to move.\n * @param {HTMLElement} b Reference to the next html element.\n * @param {Context} context Current context.\n */\nfunction moveChild(parent, node, nextRef, context) {\n  if (((parent.flags & V_COMPONENT) === 0) ||\n      ((parent.cref.flags & C_MOVE_HOOK) === 0)) {\n    parent.ref.insertBefore(node.ref, nextRef);\n  } else {\n    parent.cref.descriptor.move.call(parent.cref, node, nextRef, context);\n  }\n}\n\n/**\n * Remove VNode.\n *\n * @param {VNode} parent Parent node.\n * @param {VNode} node Node to remove.\n * @param {Context} context Current context.\n */\nfunction removeChild(parent, node, context) {\n  if (((parent.flags & V_COMPONENT) === 0) ||\n      ((parent.cref.flags & C_REMOVE_HOOK) === 0)) {\n    parent.ref.removeChild(node.ref);\n  } else {\n    parent.cref.descriptor.remove.call(parent.cref, node, context);\n  }\n}\n\n/**\n * Update childrens [a] and [b] in the [parent].\n *\n * If one of the childrens has `null` `key`, it will run update\n * algorithm for childrens with implicit keys, otherwise it will run\n * update algorithm for childrens with explicit keys.\n *\n * Mixing childrens with explicit and implicit keys in one children\n * list will result in undefined behaviour. In development mode it\n * will be checked for this conditions and if it is detected that\n * there are childrens with implicit and explicit keys, it will result\n * in runtime error.\n *\n * @param {VNode} parent Childrens parent.\n * @param {Array.<VNode>} a Old children list.\n * @param {Array.<VNode>} b New children list.\n * @param {Context} context Current context.\n */\nfunction updateChildren(parent, a, b, context) {\n  var aNode;\n  var bNode;\n  var i;\n  var unchangedPosition;\n\n  if (a != null && a.length !== 0) {\n    if (b == null || b.length === 0) {\n      // b is empty, remove all children from a.\n      for (i = 0; i < a.length; i++) {\n        removeChild(parent, a[i], context);\n      }\n    } else {\n      if (a.length === 1 && b.length === 1) {\n        // Fast path when a and b have only one child.\n        aNode = a[0];\n        bNode = b[0];\n\n        // Implicit key with same type or explicit key with same key.\n        if ((aNode.key == null && sameType(aNode, bNode)) ||\n            (aNode.key != null && aNode.key === bNode.key)) {\n          update(aNode, bNode, context);\n        } else {\n          removeChild(parent, aNode, context);\n          insertChild(parent, bNode, null, context);\n        }\n      } else if (a.length === 1) {\n        // Fast path when a have 1 child.\n        aNode = a[0];\n        if (aNode.key == null) {\n          updateImplicitChildren(parent, a, b, context);\n        } else {\n          unchangedPosition = -1;\n          for (i = 0; i < b.length; i++) {\n            bNode = b[i];\n            if (aNode.key === bNode.key) {\n              unchangedPosition = i;\n              break;\n            } else {\n              insertChild(parent, bNode, aNode.ref, context);\n            }\n          }\n          if (unchangedPosition !== -1) {\n            for (i = unchangedPosition + 1; i < b.length; i++) {\n              insertChild(parent, b[i], null, context);\n            }\n            update(aNode, b[unchangedPosition], context);\n          } else {\n            removeChild(parent, aNode, context);\n          }\n        }\n      } else if (b.length === 1) {\n        // Fast path when b have 1 child.\n        bNode = b[0];\n        if (bNode.key == null) {\n          updateImplicitChildren(parent, a, b, context);\n        } else {\n          unchangedPosition = -1;\n          for (i = 0; i < a.length; i++) {\n            aNode = a[i];\n            if (aNode.key === bNode.key) {\n              unchangedPosition = i;\n              break;\n            } else {\n              removeChild(parent, aNode, context);\n            }\n          }\n          if (unchangedPosition !== -1) {\n            for (i = unchangedPosition + 1; i < a.length; i++) {\n              removeChild(parent, a[i], context);\n            }\n            update(a[unchangedPosition], bNode, context);\n          } else {\n            insertChild(parent, bNode, null, context);\n          }\n        }\n      } else {\n        // a and b have more than 1 child.\n        if (a[0].key == null) {\n          updateImplicitChildren(parent, a, b, context);\n        } else {\n          updateExplicitChildren(parent, a, b, context);\n        }\n      }\n    }\n  } else if (b != null && b.length > 0) {\n    // a is empty, insert all children from b\n    for (i = 0; i < b.length; i++) {\n      insertChild(parent, b[i], null, context);\n    }\n  }\n}\n\n/**\n * Update childrens with implicit keys `a` and `b` in the `parent`.\n *\n * Any heuristics that is used in this algorithm is an undefined\n * behaviour, and external dependencies should not relay on the\n * knowledge about this algorithm, because it can be changed in any\n * time.\n *\n * @param {VNode} parent Childrens parent.\n * @param {Array.<VNode>} a Old children list.\n * @param {Array.<VNode>} b New children list.\n * @param {Context} context Current context.\n */\nfunction updateImplicitChildren(parent, a, b, context) {\n  var aStart = 0;\n  var bStart = 0;\n  var aEnd = a.length - 1;\n  var bEnd = b.length - 1;\n  var aNode;\n  var bNode;\n  var nextPos;\n  var next;\n\n  // Update nodes with the same type at the beginning.\n  while (aStart <= aEnd && bStart <= bEnd) {\n    aNode = a[aStart];\n    bNode = b[bStart];\n\n    if (!sameType(aNode, bNode)) {\n      break;\n    }\n\n    aStart++;\n    bStart++;\n\n    update(aNode, bNode, context);\n  }\n\n  // Update nodes with the same type at the end.\n  while (aStart <= aEnd && bStart <= bEnd) {\n    aNode = a[aEnd];\n    bNode = b[bEnd];\n\n    if (!sameType(aNode, bNode)) {\n      break;\n    }\n\n    aEnd--;\n    bEnd--;\n\n    update(aNode, bNode, context);\n  }\n\n  // Iterate through the remaining nodes and if they have the same\n  // type, then update, otherwise just remove the old node and insert\n  // the new one.\n  while (aStart <= aEnd && bStart <= bEnd) {\n    aNode = a[aStart++];\n    bNode = b[bStart++];\n    if (sameType(aNode, bNode)) {\n      update(aNode, bNode, context);\n    } else {\n      insertChild(parent, bNode, aNode.ref, context);\n      removeChild(parent, aNode, context);\n    }\n  }\n\n  // All nodes from a are updated, insert the rest from b.\n  while (aStart <= aEnd) {\n    removeChild(parent, a[aStart++], context);\n  }\n\n  nextPos = bEnd + 1;\n  next = nextPos < b.length ? b[nextPos].ref : null;\n\n  // All nodes from b are updated, remove the rest from a.\n  while (bStart <= bEnd) {\n    insertChild(parent, b[bStart++], next, context);\n  }\n}\n\n/**\n * Update childrens with explicit keys [a] and [b] in the [parent].\n *\n * @param {VNode} parent Childrens parent.\n * @param {Array.<VNode>} a Old children list.\n * @param {Array.<VNode>} b New children list.\n * @param {Context} context Current context.\n */\nfunction updateExplicitChildren(parent, a, b, context) {\n  var aStart = 0;\n  var bStart = 0;\n  var aEnd = a.length - 1;\n  var bEnd = b.length - 1;\n  var aStartNode = a[aStart];\n  var bStartNode = b[bStart];\n  var aEndNode = a[aEnd];\n  var bEndNode = b[bEnd];\n  var i;\n  var j;\n  var stop = false;\n  var nextPos;\n  var next;\n  var aNode;\n  var bNode;\n  var lastTarget;\n  var pos;\n  var node;\n\n  // Algorithm that works on simple cases with basic list\n  // transformations.\n  //\n  // It tries to reduce the diff problem by simultaneously iterating\n  // from the beginning and the end of both lists, if keys are the\n  // same, they're updated, if node is moved from the beginnin to the\n  // end of the current cursor positions or vice versa it just\n  // performs move operation and continues to reduce the diff problem.\n  outer: do {\n    stop = true;\n\n    // Update nodes with the same key at the beginning.\n    while (aStartNode.key === bStartNode.key) {\n      update(aStartNode, bStartNode, context);\n      aStart++;\n      bStart++;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aStartNode = a[aStart];\n      bStartNode = b[bStart];\n      stop = false;\n    }\n\n    // Update nodes with the same key at the end.\n    while (aEndNode.key === bEndNode.key) {\n      update(aEndNode, bEndNode, context);\n      aEnd--;\n      bEnd--;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aEndNode = a[aEnd];\n      bEndNode = b[bEnd];\n      stop = false;\n    }\n\n    // Move nodes from left to right.\n    while (aStartNode.key === bEndNode.key) {\n      update(aStartNode, bEndNode, context);\n      nextPos = bEnd + 1;\n      next = nextPos < b.length ? b[nextPos].ref : null;\n      moveChild(parent, bEndNode, next, context);\n      aStart++;\n      bEnd--;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aStartNode = a[aStart];\n      bEndNode = b[bEnd];\n      stop = false;\n    }\n\n    // Move nodes from right to end.\n    while (aEndNode.key === bStartNode.key) {\n      update(aEndNode, bStartNode, context);\n      moveChild(parent, aEndNode, a[aStart].ref, context);\n      aEnd--;\n      bStart++;\n      if (aStart > aEnd || bStart > bEnd) {\n        break outer;\n      }\n      aEndNode = a[aEnd];\n      bStartNode = b[bStart];\n      stop = false;\n    }\n  } while (!stop && aStart <= aEnd && bStart <= bEnd);\n\n  if (aStart > aEnd) {\n    // All nodes from a are updated, insert the rest from b.\n    nextPos = bEnd + 1;\n    next = nextPos < b.length ? b[nextPos].ref : null;\n    while (bStart <= bEnd) {\n      insertChild(parent, b[bStart++], next, context);\n    }\n  } else if (bStart > bEnd) {\n    // All nodes from b are updated, remove the rest from a.\n    while (aStart <= aEnd) {\n      removeChild(parent, a[aStart++], context);\n    }\n  } else {\n    // Perform more complex update algorithm on the remaining nodes.\n    //\n    // We start by marking all nodes from b as inserted, then we try\n    // to find all removed nodes and simultaneously perform updates on\n    // the nodes that exists in both lists and replacing \"inserted\"\n    // marks with the position of the node from the list b in list a.\n    // Then we just need to perform slightly modified LIS algorith,\n    // that ignores \"inserted\" marks and find common subsequence and\n    // move all nodes that doesn't belong to this subsequence, or\n    // insert if they have \"inserted\" mark.\n    var aLength = aEnd - aStart + 1;\n    var bLength = bEnd - bStart + 1;\n    var sources = new Array(bLength);\n\n    // Mark all nodes as inserted.\n    for (i = 0; i < bLength; i++) {\n      sources[i] = -1;\n    }\n\n    var moved = false;\n    var removeOffset = 0;\n\n    // When lists a and b are small, we are using naive O(M*N) algorithm\n    // to find removed children.\n    if (aLength * bLength <= 16) {\n      for (i = aStart; i <= aEnd; i++) {\n        var removed = true;\n        aNode = a[i];\n        for (j = bStart; j <= bEnd; j++) {\n          bNode = b[j];\n          if (aNode.key === bNode.key) {\n            sources[j - bStart] = i;\n\n            if (lastTarget > j) {\n              moved = true;\n            } else {\n              lastTarget = j;\n            }\n            update(aNode, bNode, context);\n            removed = false;\n            break;\n          }\n        }\n        if (removed) {\n          removeChild(parent, aNode, context);\n          removeOffset++;\n        }\n      }\n    } else {\n      var keyIndex = {};\n\n      for (i = bStart; i <= bEnd; i++) {\n        node = b[i];\n        keyIndex[node.key] = i;\n      }\n\n      for (i = aStart; i <= aEnd; i++) {\n        aNode = a[i];\n        j = keyIndex[aNode.key];\n\n        if (j != null) {\n          bNode = b[j];\n          sources[j - bStart] = i;\n          if (lastTarget > j) {\n            moved = true;\n          } else {\n            lastTarget = j;\n          }\n          update(aNode, bNode, context);\n        } else {\n          removeChild(parent, aNode, context);\n          removeOffset++;\n        }\n      }\n    }\n\n    if (moved) {\n      var seq = _lis(sources);\n      // All modifications are performed from the right to left, so we\n      // can use insertBefore method and use reference to the html\n      // element from the next VNode. All Nodes from the right side\n      // should always be in the correct state.\n      j = seq.length - 1;\n      for (i = bLength - 1; i >= 0; i--) {\n        if (sources[i] === -1) {\n          pos = i + bStart;\n          node = b[pos];\n          nextPos = pos + 1;\n          next = nextPos < b.length ? b[nextPos].ref : null;\n          insertChild(parent, node, next, context);\n        } else {\n          if (j < 0 || i != seq[j]) {\n            pos = i + bStart;\n            node = a[sources[i]];\n            nextPos = pos + 1;\n            next = nextPos < b.length ? b[nextPos].ref : null;\n            moveChild(parent, node, next, context);\n          } else {\n            j--;\n          }\n        }\n      }\n    } else if (aLength - removeOffset != bLength) {\n      for (i = bLength - 1; i >= 0; i--) {\n        if (sources[i] === -1) {\n          pos = i + bStart;\n          node = b[pos];\n          nextPos = pos + 1;\n          next = nextPos < b.length ? b[nextPos].ref : null;\n          insertChild(parent, node, next, context);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Slightly modified Longest Increased Subsequence algorithm, it\n * ignores items that have -1 value. They're representing new items.\n *\n * This algorithm is used to find minimum number of move operations\n * when updating childrens with explicit keys.\n *\n * http://en.wikipedia.org/wiki/Longest_increasing_subsequence\n *\n * @param {Array.<number>} a\n * @return {Array.<number>}\n */\nfunction _lis(a) {\n  var p = a.slice(0);\n  var result = [0];\n  var i, il;\n  var j;\n  var u;\n  var v;\n  var c;\n\n  for (i = 0, il = a.length; i < il; i++) {\n    if (a[i] === -1) {\n      continue;\n    }\n\n    j = result[result.length - 1];\n    if (a[j] < a[i]) {\n      p[i] = j;\n      result.push(i);\n      continue;\n    }\n\n    u = 0;\n    v = result.length - 1;\n\n    while (u < v) {\n      c = ((u + v) / 2) | 0;\n      if (a[result[c]] < a[i]) {\n        u = c + 1;\n      } else {\n        v = c;\n      }\n    }\n\n    if (a[i] < a[result[u]]) {\n      if (u > 0) {\n        p[i] = result[u - 1];\n      }\n      result[u] = i;\n    }\n  }\n\n  u = result.length;\n  v = result[u - 1];\n\n  while (u-- > 0) {\n    result[u] = v;\n    v = p[v];\n  }\n\n  return result;\n}\n\n/**\n * Custom Elements\n */\nvar E_INIT_HOOK = 4;\nvar E_UPDATE_HOOK = 8;\n\nfunction declareElement(spec) {\n  var flags = 0;\n  var tag = spec.tag;\n  var init = spec.init;\n  var update = spec.update;\n\n  if (tag === void 0) tag = 'div';\n\n  if (init === void 0) init = null;\n  else flags |= E_INIT_HOOK;\n\n  if (update === void 0) update = null;\n  else flags |= E_UPDATE_HOOK;\n\n  return {\n    flags: flags,\n    tag: tag,\n    init: init,\n    update: update\n  };\n}\n\nfunction createElement(descriptor, data) {\n  var e = document.createElement(descriptor.tag);\n  if ((descriptor.flags & E_INIT_HOOK) !== 0) {\n    descriptor.init.call(e, data);\n  }\n  return e;\n}\n\nfunction updateElement(element, descriptor, oldData, newData) {\n  if ((descriptor.flags & E_UPDATE_HOOK) !== 0) {\n    descriptor.update.call(element, oldData, newData);\n  }\n}\n\n/**\n * Components\n */\nvar C_DIRTY = 1;\nvar C_STATEFUL = 2;\nvar C_DOM_ATTACHED = 4;\nvar C_RENDERED = 8;\nvar C_MOUNTED = 16;\nvar C_UPDATE_PROPS_HOOK = 128;\nvar C_UPDATE_STATE_HOOK = 256;\nvar C_INIT_HOOK = 512;\nvar C_BUILD_HOOK = 1024;\nvar C_ATTACHED_HOOK = 2048;\nvar C_DETACHED_HOOK = 4096;\nvar C_DOM_ATTACHED_HOOK = 8192;\nvar C_DOM_DETACHED_HOOK = 16384;\nvar C_UPDATE_HOOK = 65536;\nvar C_INSERT_HOOK = 262144;\nvar C_MOVE_HOOK = 524288;\nvar C_REMOVE_HOOK = 1048576;\n\n/**\n * Component.\n *\n * @param {!Object} descriptor Component descriptor object.\n * @param {!Component} parent Parent component.\n * @param {Object} data Component data.\n * @final\n * @constructor\n * @struct\n */\nfunction Component(descriptor, parent, props) {\n  var flags = descriptor.flags;\n\n  /**\n   * Component flags.\n   * @type {number}\n   */\n  this.flags = flags | C_DIRTY;\n\n  /**\n   * ComponentDescriptor.\n   * @type {!Object}\n   */\n  this.descriptor = descriptor;\n\n  /**\n   * Depth relative to other Components.\n   * @type {number}\n   */\n  this.depth = parent == null ? 0 : parent.depth + 1;\n\n  /**\n   * Parent Component.\n   * @type {Component}\n   */\n  this.parent = parent;\n\n  this.props = props;\n\n  /**\n   * Component State.\n   * @type {!DNode}\n   */\n  if ((flags & C_UPDATE_STATE_HOOK) === 0) {\n    this.state = null;\n  } else {\n    this.state = DNode.create();\n    this.state.invalidated = this.invalidate;\n    this.state.ctx = this;\n  }\n\n  this.rev = -1;\n\n  /**\n   * Root node in the Components virtual tree.\n   * @type {VNode}\n   */\n  this.root = null;\n\n  /**\n   * Reference to the Html Element.\n   * @type {HTMLElement}\n   */\n  this.element = document.createElement(descriptor.tag);\n\n  /**\n   * updateLater bound method.\n   * @type {function(this:!Component)}\n   */\n  this._update = null;\n\n  if ((flags & C_INIT_HOOK) !== 0) {\n    descriptor.init.call(this);\n  }\n}\n\n/**\n * Create Component Descriptor Object\n * @nosideeffects\n * @param {!Object} decl Component declaration\n * @return {!Object}\n */\nfunction declareComponent(spec) {\n  var flags = 0|0;\n  var tag = spec.tag;\n  var updateProps = spec.updateProps;\n  var updateState = spec.updateState;\n  var init = spec.init;\n  var build = spec.build;\n  var attached = spec.attached;\n  var detached = spec.detached;\n  var domAttached = spec.domAttached;\n  var domDetached = spec.domDetached;\n  var update = spec.update;\n  var insert = spec.insert;\n  var move = spec.move;\n  var remove = spec.remove;\n\n  if (tag === void 0) tag = 'div';\n\n  if (updateProps === void 0) updateProps = null;\n  else flags |= C_UPDATE_PROPS_HOOK;\n\n  if (updateState === void 0) updateState = null;\n  else flags |= C_STATEFUL | C_UPDATE_STATE_HOOK;\n\n  if (init === void 0) init = null;\n  else flags |= C_INIT_HOOK;\n\n  if (build === void 0) build = null;\n  else flags |= C_BUILD_HOOK;\n\n  if (attached === void 0) attached = null;\n  else flags |= C_ATTACHED_HOOK;\n\n  if (detached === void 0) detached = null;\n  else flags |= C_DETACHED_HOOK;\n\n  if (domAttached === void 0) domAttached = null;\n  else flags |= C_DOM_ATTACHED_HOOK;\n\n  if (domDetached === void 0) domDetached = null;\n  else flags |= C_DOM_DETACHED_HOOK;\n\n  if (update === void 0) update = null;\n  else flags |= C_UPDATE_HOOK;\n\n  if (insert === void 0) insert = null;\n  else flags |= C_INSERT_HOOK;\n\n  if (move === void 0) move = null;\n  else flags |= C_MOVE_HOOK;\n\n  if (remove === void 0) remove = null;\n  else flags |= C_REMOVE_HOOK;\n\n  return {\n    flags: flags,\n    updateProps: updateProps,\n    updateState: updateState,\n    init: init,\n    build: build,\n    attached: attached,\n    detached: detached,\n    domAttached: domAttached,\n    domDetached: domDetached,\n    update: update,\n    insert: insert,\n    move: move,\n    remove: remove,\n    tag: tag\n  };\n};\n\nfunction createComponent(descriptor, props, ctx) {\n  return new Component(descriptor, ctx, props);\n};\n\nComponent.prototype.domAttach = function() {};\nComponent.prototype.domDetach = function() {};\nComponent.prototype.attach = function() {};\nComponent.prototype.detach = function() {};\n\nComponent.prototype.updateProps = function(props) {\n  if ((this.flags & C_UPDATE_PROPS_HOOK) !== 0) {\n    if (this.descriptor.updateProps.call(this, props)) {\n      this.flags |= C_DIRTY;\n    }\n  } else {\n    // TODO: shallow equal check by default\n    this.props = props;\n    this.flags |= C_DIRTY;\n  }\n};\n\nComponent.prototype.update = function() {\n  var flags = this.flags;\n\n  if ((flags & C_DIRTY) !== 0) {\n    var descriptor = this.descriptor;\n\n    if ((flags & C_UPDATE_HOOK) === 0) {\n      if ((flags & C_UPDATE_STATE_HOOK) !== 0) {\n        descriptor.updateState.call(this);\n        if (this.rev < this.state.rev) {\n          this.updateView(descriptor.build.call(this));\n        }\n      } else {\n        this.updateView(descriptor.build.call(this));\n      }\n      this.flags &= ~C_DIRTY;\n    } else {\n      descriptor.update.call(this);\n    }\n    this.rev = ENV.scheduler.clock;\n  }\n};\n\nComponent.prototype.updateView = function(newRoot) {\n  var root = this.root;\n\n  if (root == null) {\n    newRoot.ref = this.element;\n    newRoot.cref = this;\n    render(newRoot, this);\n  } else {\n    update(root, newRoot, this);\n  }\n  this.root = newRoot;\n};\n\nComponent.prototype.invalidate = function() {\n  if ((this.flags & C_DIRTY) === 0) {\n    this.flags |= C_DIRTY;\n    if (this._update == null) {\n      this._update = this.update.bind(this);\n    }\n\n    ENV.scheduler.nextFrame().write(this._update, this.depth);\n  }\n};\n\nComponent.prototype.dispose = function() {\n  if ((this.flags & C_STATEFUL) !== 0) {\n    this.state.dispose();\n  }\n};\n\nfunction injectComponent(component, parent) {\n  parent.appendChild(component.element);\n  component.attach();\n  component.domAttach();\n  component.update();\n};\n\nmodule.exports = {\n  VNode: VNode,\n  Component: Component,\n  declareElement: declareElement,\n  declareComponent: declareComponent,\n  create: create,\n  render: render,\n  update: update,\n  createComponent: createComponent,\n  t: text,\n  $t: $text,\n  e: element,\n  $e: $element,\n  d: customElement,\n  $d: $customElement,\n  s: svg,\n  $s: $svg,\n  c: component,\n  $c: $component,\n  r: root,\n  injectComponent: injectComponent\n};\n\n},{\"./dnode\":2,\"./env\":3}],7:[function(require,module,exports){\n'use strict';\n\nvar app = {\n  store: null,\n  cache: null\n};\n\nmodule.exports = app;\n\n},{}],8:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar DNode = kivi.DNode;\n\nvar app = require('./app');\n\nvar DatabaseCache = function() {\n  this._queries = {};\n};\n\nDatabaseCache.prototype.getTopFiveQueries = function(id) {\n  var qs = this._queries[id];\n  if (qs === void 0) {\n    qs = DNode.create();\n    this._queries[id] = qs;\n  }\n\n  if (qs.dirty) {\n    var db = app.store.get(id);\n    qs.sub(db);\n\n    var queries = db.data.queries.slice();\n    queries.sort(function(a, b) {\n      return a.elapsed - b.elapsed;\n    });\n    queries = queries.slice(0, 5);\n    while (queries.length < 5) {\n      queries.push({\n        elapsed: 0,\n        query: '',\n        waiting: 0\n      });\n    }\n\n    qs.data = queries;\n    qs.update(true);\n  }\n\n  return qs;\n};\n\nmodule.exports = DatabaseCache;\n\n},{\"./app\":7,\"kivi\":4}],9:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar vdom = kivi.vdom;\n\nvar app = require('../app');\nvar Popover = require('./popover');\n\nfunction _formatElapsed(v) {\n  if (!v) return '';\n\n  var str = parseFloat(v).toFixed(2);\n\n  if (v > 60) {\n    var minutes = Math.floor(v / 60);\n    var comps = (value % 60).toFixed(2).split('.');\n    var seconds = comps[0].lpad('0', 2);\n    var ms = comps[1];\n    str = minutes + \":\" + seconds + \".\" + ms;\n  }\n\n  return str;\n}\n\nvar _IMPORTANT_CLASS = ['label-important'];\nvar _WARNING_CLASS = ['label-warning'];\nvar _SUCCESS_CLASS = ['label-success'];\n\nvar Entry = vdom.declareComponent({\n  tag: 'tr',\n\n  updateState: function() {\n    var queries = app.cache.getTopFiveQueries(this.props.db.data.id);\n    this.state.sub(queries);\n    this.state.data = {\n      topFiveQueries: queries.data\n    };\n    this.state.update(true);\n  },\n\n  build: function() {\n    var db = this.props.db.data;\n    var topFiveQueries = this.state.data.topFiveQueries;\n\n    var name = vdom.e('td');\n    name.type = 'dbname';\n    name.children = [vdom.t(db.name)];\n\n    var count = db.queries.length;\n\n    var qcSpan = vdom.e('span');\n    qcSpan.type = 'label';\n    qcSpan.children = [vdom.t(count)];\n    if (count >= 20) {\n      qcSpan.classes = _IMPORTANT_CLASS;\n    } else if (count >= 10) {\n      qcSpan.classes = _WARNING_CLASS;\n    } else {\n      qcSpan.classes = _SUCCESS_CLASS;\n    }\n\n    var qc = vdom.e('td');\n    qc.type = 'query-count';\n    qc.children = [qcSpan];\n\n    var children = [name, qc];\n\n    for (var i = 0; i < 5; i++) {\n      var q = topFiveQueries[i];\n      var elapsed = q.elapsed;\n      var text = vdom.t(_formatElapsed(elapsed));\n      var popover = vdom.c(Popover, {query: q.query});\n\n      var col = vdom.e('td');\n      col.type = 'Query';\n      var classes = [];\n      classes.push('elapsed');\n      if (elapsed >= 10.0) {\n        classes.push('warn_long');\n      } else if (elapsed >= 1.0) {\n        classes.push('warn');\n      } else {\n        classes.push('short');\n      }\n      col.classes = classes;\n      col.children = [text, popover];\n      children.push(col);\n    }\n\n    var root = vdom.r();\n    root.children = children;\n    return root;\n  }\n});\n\nmodule.exports = Entry;\n},{\"../app\":7,\"./popover\":11,\"kivi\":4}],10:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar vdom = kivi.vdom;\n\nvar app = require('../app');\nvar Entry = require('./entry');\n\nvar _ROOT_CLASSES = ['table', 'table-striped', 'latest-data'];\n\nvar Main = vdom.declareComponent({\n  tag: 'table',\n\n  updateState: function() {\n    var dbs = app.store.getAll();\n    this.state.sub(dbs);\n    this.state.data = dbs.data;\n    this.state.update(true);\n  },\n\n  build: function() {\n    var dbs = this.state.data;\n\n    var rows = [];\n    for (var i = 0; i < dbs.length; i++) {\n      var db = dbs[i];\n      rows.push(vdom.$c(db.data.id, Entry, {db: db}));\n    }\n\n    var tbody = vdom.e('tbody');\n    tbody.children = rows;\n\n    var root = vdom.r();\n    root.classes = _ROOT_CLASSES;\n    root.children = [tbody];\n\n    return root;\n  }\n});\n\nmodule.exports = Main;\n\n},{\"../app\":7,\"./entry\":9,\"kivi\":4}],11:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar vdom = kivi.vdom;\n\nvar _ROOT_CLASSES = ['popover', 'left'];\n\nvar Popover = vdom.declareComponent({\n  build: function() {\n    var content = vdom.e('div');\n    content.type = 'popover-content';\n    content.children = [vdom.t(this.props.query)];\n\n    var arrow = vdom.e('div');\n    arrow.type = 'arrow';\n\n    var root = vdom.r();\n    root.classes = _ROOT_CLASSES;\n    root.children = [content, arrow];\n\n    return root;\n  }\n});\n\nmodule.exports = Popover;\n\n},{\"kivi\":4}],12:[function(require,module,exports){\n'use strict';\n\nvar kivi = require('kivi');\nvar DNode = kivi.DNode;\n\nvar _nextId = 0;\n\nfunction DatabaseStore(n) {\n  var dbs = [];\n\n  for (var i = 0; i < n; i++) {\n    dbs.push(DNode.create({\n      id: _nextId++,\n      name: 'cluster' + i,\n      queries: null\n    }));\n    dbs.push(DNode.create({\n      id: _nextId++,\n      name: 'cluster' + i + 'slave',\n      queries: null\n    }));\n  }\n\n  this._dbs = DNode.create(dbs);\n  this.update();\n}\n\nDatabaseStore.prototype.getAll = function() {\n  return this._dbs;\n};\n\nDatabaseStore.prototype.get = function(id) {\n  return this._dbs.data[id];\n};\n\nDatabaseStore.prototype.update = function() {\n  var dbs = this._dbs.data;\n\n  for (var i = 0; i < dbs.length; i++) {\n    var db = dbs[i];\n\n    var queries = [];\n\n    var r = Math.floor((Math.random() * 10) + 1);\n    for (var j = 0; j < r; j++) {\n      var q = {\n        elapsed: Math.random() * 15,\n        query: 'SELECT blah FROM something',\n        waiting: Math.random() < 0.5\n      };\n\n      if (Math.random() < 0.2) {\n        q.query = '<IDLE> in transaction';\n      }\n\n      if (Math.random() < 0.1) {\n        q.query = 'vacuum';\n      }\n\n      queries.push(q);\n    }\n    db.data.queries = queries;\n    db.commit();\n  }\n};\n\nmodule.exports = DatabaseStore;\n},{\"kivi\":4}]},{},[1]);\n"],"sourceRoot":"/source/"}