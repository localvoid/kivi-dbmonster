!function t(e,n,r){function s(l,a){if(!n[l]){if(!e[l]){var o="function"==typeof require&&require;if(!a&&o)return o(l,!0);if(i)return i(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[l]={exports:{}};e[l][0].call(f.exports,function(t){var n=e[l][1][t];return s(n?n:t)},f,f.exports,t,e,n,r)}return n[l].exports}for(var i="function"==typeof require&&require,l=0;l<r.length;l++)s(r[l]);return s}({1:[function(t){"use strict";function e(t){for(var e=0;e<t.length;e++)t[e].update()}function n(){i.init(new l);for(var t=[],n=0;s>n;n++)t.push(new a.Database("cluster"+n)),t.push(new a.Database("cluster"+n+"slave"));var u=i.vdom.createComponent(o,{dbs:t});setInterval(function(){e(t),u.invalidate()},r),i.nextFrame().write(function(){i.vdom.injectComponent(u,document.body)})}var r=0,s=100,i=t("kivi"),l=t("kivi/lib/scheduler"),a=t("./data"),o=t("./component/main");document.addEventListener("DOMContentLoaded",function(){n()})},{"./component/main":9,"./data":11,kivi:4,"kivi/lib/scheduler":5}],2:[function(t,e){"use strict";function n(t){null==t?(this.dirty=!0,this.rev=-1,this.data=null):(this.dirty=!1,this.rev=s.scheduler.dataClock,this.data=t),this.data=t,this.deps=null,this.subs=null,this.invalidated=null,this.ctx=null}function r(t){if(!t.dirty){t.dirty=!0,null!=t.invalidated&&t.invalidated.call(t.ctx,t);var e=t.subs;if(null!=e)for(var n=0;n<e.length;n++)r(e[n]);t.deps=null,t.subs=null}}var s=t("./env");n.create=function(t){return void 0===t&&(t=null),new n(t)},n.prototype.reset=function(){var t=this.deps;if(null!=t)for(var e=0;e<t.length;e++){var n=t[e].subs;n[n.indexOf(this)]=n[n.length-1],n.pop()}this.deps=null},n.prototype.sub=function(t){null==this.deps&&(this.deps=[]),this.deps.push(t),null==t.subs&&(t.subs=[]),t.subs.push(this)},n.prototype.update=function(t){t&&(this.rev=s.scheduler.dataClock),this.dirty=!1},n.prototype.commit=function(){this.rev=s.scheduler.dataClock;var t=this.subs;if(null!=t)for(var e=0;e<t.length;e++)r(t[e])},e.exports=n},{"./env":3}],3:[function(t,e){"use strict";var n={scheduler:null};e.exports=n},{}],4:[function(t,e){"use strict";function n(t){l.scheduler=t}function r(){return l.scheduler.nextFrame()}function s(t){l.scheduler.scheduleMicrotask(t)}function i(t){l.scheduler.action(t)}var l=t("./env"),a=t("./dnode"),o=t("./vdom");e.exports={ENV:l,DNode:a,vdom:o,init:n,nextFrame:r,scheduleMicrotask:s,action:i}},{"./dnode":2,"./env":3,"./vdom":7}],5:[function(t,e){"use strict";function n(t){this._observer=new window.MutationObserver(t),this._node=document.createTextNode(""),this._observer.observe(this._node,{characterData:!0})}function r(){this.flags=0,this.writeTaskGroups=[],this.writeTasks=null,this.readTasks=null,this.afterTasks=null}function s(){this.flags=0,this.dataClock=0,this.clock=-1,this._actions=null,this._microtasks=null,this._currentFrame=new r,this._nextFrame=new r;var t=this;this._microtaskScheduler=new n(function(){t.flags&=~h,t.flags|=f,t.clock++;var e=t._microtasks;if(null!=e){t._microtasks=null;for(var n=0;n<e.length;n++)e[n]()}t.dataClock++,t.performActions(),t.flags&=~f}),this._handleAnimationFrame=function(){var e,n,r,s,h,d;t.flags&=~c,t.flags|=f,t.clock++,e=t._nextFrame,t._nextFrame=t._currentFrame,t._currentFrame=e;do{for(;0!==(e.flags&u);){if(0!==(e.flags&i))for(e.flags&=~i,n=e.writeTaskGroups,h=0;h<n.length;h++)if(r=n[h],null!=r)for(n[h]=null,d=0;d<r.length;d++)(s=r[d])();if(0!==(e.flags&l))for(e.flags&=~l,r=e.writeTasks,h=0;h<r.length;h++)(s=r[h])()}for(;0!==(e.flags&a);)for(e.flags&=~a,r=e.readTasks,e.readTasks=null,h=0;h<r.length;h++)(s=r[h])()}while(0!==(e.flags&u));for(;0!==(e.flags&o);)for(e.flags&=~o,r=e.afterTasks,h=0;h<r.length;h++)(s=r[h])();t.dataClock++,t.performActions(),t.flags&=~f}}n.prototype.requestNextTick=function(){this._toggle^=1,this._node.data=this._toggle};var i=4,l=8,a=16,o=32,u=l|i;r.prototype.write=function(t,e){var n;if(void 0===e&&(e=-1),-1===e)this.flags|=l,null==this.writeTasks&&(this.writeTasks=[]),this.writeTasks.push(t);else{for(this.flags|=i;e>=this.writeTaskGroups.length;)this.writeTaskGroups.push(null);n=this.writeTaskGroups[e],null==n&&(n=this.writeTaskGroups[e]=[]),n.push(t)}},r.prototype.read=function(t){this.flags|=a,null==this.readTasks&&(this.readTasks=[]),this.readTasks.push(t)},r.prototype.after=function(t){this.flags|=o,null==this.afterTasks&&(this.afterTasks=[]),this.afterTasks.push(t)};var f=1,h=2,c=4;s.prototype.currentFrame=function(){return this._currentFrame},s.prototype.nextFrame=function(){return 0===(this.flags&c)&&(this.flags|=c,window.requestAnimationFrame(this._handleAnimationFrame)),this._nextFrame},s.prototype.scheduleMicrotask=function(t){0===(this.flags&h)&&(this.flags|=h,this._microtaskScheduler.requestNextTick()),null==this._microtasks&&(this._microtasks=[]),this._microtasks.push(t)},s.prototype.action=function(t){0===(this.flags&h)&&(this.flags|=h,this._microtaskScheduler.requestNextTick()),null==this._actions&&(this._actions=[]),this._actions.push(t)},s.prototype.performActions=function(){for(;null!=this._actions;){var t=this._actions;this._actions=null;for(var e=0;e<t.length;e++)t[e]()}},e.exports=s},{}],6:[function(t,e){"use strict";function n(t,e){var n;for(n in t){var r=e[n];if(void 0===r||t[n]!==r)return!1}for(n in e)if(!t.hasOwnProperty(n))return!1;return!0}e.exports={shallowEq:n}},{}],7:[function(t,e){"use strict";function n(t,e,n,r){this.flags=t,this.key=e,this.tag=n,this.data=r,this.type=null,this.attrs=null,this.style=null,this.classes=null,this.children=null,this.ref=null,this.cref=null}function r(t){return new n(O,null,null,t)}function s(t,e){return new n(O,t,null,e)}function i(t){return new n(S,null,t,null)}function l(t,e){return new n(S,t,e,null)}function a(t){return new n(S|G,null,t,null)}function o(t,e){return new n(S|G,t,e,null)}function u(t,e){return void 0===e&&(e=null),new n(D,null,t,e)}function f(t,e,r){return void 0===r&&(r=null),new n(D,t,e,r)}function h(){return new n(L,null,null,null)}function c(t,e){return t.flags===e.flags&&t.tag===e.tag}function d(t,e){var n=t.flags;if(0!==(n&O))t.ref=document.createTextNode(t.data);else if(0!==(n&S))t.ref=0===(n&G)?document.createElement(t.tag):document.createElementNS("http://www.w3.org/2000/svg",t.tag);else if(0!==(n&D)){var r=q(t.tag,t.data,e);t.ref=r.element,t.cref=r}}function p(t,e){var n,r,s,i=t.flags;if(0!==(i&(S|D|L))){var l=t.ref;if(null!=t.attrs)for(s in t.attrs)l.setAttribute(s,t.attrs[s]);if(null!=t.style){var a=l.style;for(s in t.style)a.setProperty(s,t.style[s])}if(0!==(i&S)){var o=null;if(null!=t.type&&(o=t.type),null!=t.classes){var u=t.classes.join(" ");o=null==o?u:o+" "+u}null!=o&&(t.data=o,l.className=o)}else{var f=null;if(null!=t.type&&(f=l.classList,f.add(t.type)),null!=t.classes)for(null==f&&(f=l.classList),n=0,r=t.classes.length;r>n;n++)f.add(t.classes[n])}if(0!==(i&D))t.cref.update();else if(null!=t.children)for(n=0,r=t.children.length;r>n;n++)k(t,t.children[n],null,e)}}function v(t,e,n){var r=t.ref,s=t.flags;if(e.ref=r,0!==(s&O))t.data!=e.data&&(t.ref.nodeValue=e.data);else if(0!==(s&(S|D|L))){if(t.attrs!==e.attrs&&g(t.attrs,e.attrs,r),t.style!==e.style&&y(t.style,e.style,r.style),0!==(s&S)){var i=null;if(null!=e.type&&(i=e.type),null!=e.classes){var l=e.classes.join(" ");i=null==i?l:i+" "+l}e.data=i,t.data!==e.data&&(r.className=i)}else t.classes!==e.classes&&m(t.classes,e.classes,r.classList);if(0!==(s&D)){var a=e.cref=t.cref;t.data!==e.data&&a.updateProps(e.data),a.update()}else _(t,t.children,e.children,n)}}function g(t,e,n){var r,s,i;if(null!=t)if(null==e)for(r in t)n.removeAttribute(r);else{for(r in t)i=e[r],void 0===i?n.removeAttribute(r):(s=t[r],s!==i&&n.setAttribute(r,i));for(r in e)s=t[r],void 0===s&&n.setAttribute(r,e[r])}else if(null!=e)for(r in e)n.setAttribute(r,e[r])}function y(t,e,n){var r,s;if(null!=t)if(null==e)for(r in t)n.removeProperty(r);else{for(r in t)s=e[r],void 0===s?n.removeProperty(r):n.setProperty(r,s);for(r in e)s=t[r],void 0===s&&n.setProperty(r,e[r])}else if(null!=e)for(r in e)n.setProperty(r,e[r])}function m(t,e,n){var r,s,i,l,a,o,u,f;if(null!=t&&t.length>0)if(null==e||0===e.length)for(r=0;r<t.length;r++)n.remove(t[r]);else if(t.length*e.length<=16){for(o=new Array(e.length),r=0;r<t.length;r++){for(l=t[r],u=!0,s=0;s<e.length;s++)if(a=e[s],l===a){u=!1,o[s]=!0;break}u&&n.remove(l)}for(r=0;r<e.length;r++)1!=o[r]&&n.add(e[r])}else{for(f={},r=0;r<e.length;r++)a=e[r],f[a]=!1;for(r=0;r<t.length;r++)l=t[r],void 0===f[l]?n.remove(l):f[l]=!0;for(i in f)f[i]===!1&&n.add(i)}else if(null!=e&&e.length>0)for(r=0;r<e.length;r++)n.add(e[r])}function k(t,e,n,r){d(e,r),t.ref.insertBefore(e.ref,n),p(e,r)}function w(t,e,n){t.ref.insertBefore(e.ref,n)}function b(t,e){t.ref.removeChild(e.ref)}function _(t,e,n,r){var s,i,l,a;if(null!=e&&0!==e.length)if(null==n||0===n.length)for(l=0;l<e.length;l++)b(t,e[l],r);else if(1===e.length&&1===n.length)s=e[0],i=n[0],null==s.key&&c(s,i)||null!=s.key&&s.key===i.key?v(s,i,r):(b(t,s,r),k(t,i,null,r));else if(1===e.length)if(s=e[0],null==s.key)T(t,e,n,r);else{for(a=-1,l=0;l<n.length;l++){if(i=n[l],s.key===i.key){a=l;break}k(t,i,s.ref,r)}if(-1!==a){for(l=a+1;l<n.length;l++)k(t,n[l],null,r);v(s,n[a],r)}else b(t,s,r)}else if(1===n.length)if(i=n[0],null==i.key)T(t,e,n,r);else{for(a=-1,l=0;l<e.length;l++){if(s=e[l],s.key===i.key){a=l;break}b(t,s,r)}if(-1!==a){for(l=a+1;l<e.length;l++)b(t,e[l],r);v(e[a],i,r)}else k(t,i,null,r)}else null==e[0].key?T(t,e,n,r):x(t,e,n,r);else if(null!=n&&n.length>0)for(l=0;l<n.length;l++)k(t,n[l],null,r)}function T(t,e,n,r){for(var s,i,l,a,o=0,u=0,f=e.length-1,h=n.length-1;f>=o&&h>=u&&(s=e[o],i=n[u],c(s,i));)o++,u++,v(s,i,r);for(;f>=o&&h>=u&&(s=e[f],i=n[h],c(s,i));)f--,h--,v(s,i,r);for(;f>=o&&h>=u;)s=e[o++],i=n[u++],c(s,i)?v(s,i,r):(k(t,i,s.ref,r),b(t,s,r));for(;f>=o;)b(t,e[o++],r);for(l=h+1,a=l<n.length?n[l].ref:null;h>=u;)k(t,n[u++],a,r)}function x(t,e,n,r){var s,i,l,a,o,u,f,h,c,d=0,p=0,g=e.length-1,y=n.length-1,m=e[d],_=n[p],T=e[g],x=n[y],F=!1;t:do{for(F=!0;m.key===_.key;){if(v(m,_,r),d++,p++,d>g||p>y)break t;m=e[d],_=n[p],F=!1}for(;T.key===x.key;){if(v(T,x,r),g--,y--,d>g||p>y)break t;T=e[g],x=n[y],F=!1}for(;m.key===x.key;){if(v(m,x,r),l=y+1,a=l<n.length?n[l].ref:null,w(t,x,a,r),d++,y--,d>g||p>y)break t;m=e[d],x=n[y],F=!1;continue t}for(;T.key===_.key;){if(v(T,_,r),w(t,_,m.ref,r),g--,p++,d>g||p>y)break t;T=e[g],_=n[p],F=!1}}while(!F&&g>=d&&y>=p);if(d>g)for(l=y+1,a=l<n.length?n[l].ref:null;y>=p;)k(t,n[p++],a,r);else if(p>y)for(;g>=d;)b(t,e[d++],r);else{var E=g-d+1,q=y-p+1,P=new Array(q);for(s=0;q>s;s++)P[s]=-1;var A=!1,M=0;if(16>=E*q)for(s=d;g>=s;s++){var N=!0;for(o=e[s],i=p;y>=i;i++)if(u=n[i],o.key===u.key){P[i-p]=s,f>i?A=!0:f=i,v(o,u,r),N=!1;break}N&&(b(t,o,r),M++)}else{var O={};for(s=p;y>=s;s++)c=n[s],O[c.key]=s;for(s=d;g>=s;s++)o=e[s],i=O[o.key],null!=i?(u=n[i],P[i-p]=s,f>i?A=!0:f=i,v(o,u,r)):(b(t,o,r),M++)}if(A){var S=C(P);for(i=S.length-1,s=q-1;s>=0;s--)-1===P[s]?(h=s+p,c=n[h],l=h+1,a=l<n.length?n[l].ref:null,k(t,c,a,r)):0>i||s!=S[i]?(h=s+p,c=n[h],l=h+1,a=l<n.length?n[l].ref:null,w(t,c,a,r)):i--}else if(E-M!=q)for(s=q-1;s>=0;s--)-1===P[s]&&(h=s+p,c=n[h],l=h+1,a=l<n.length?n[l].ref:null,k(t,c,a,r))}}function C(t){var e,n,r,s,i,l,a=t.slice(0),o=[0];for(e=0,n=t.length;n>e;e++)if(-1!==t[e])if(r=o[o.length-1],t[r]<t[e])a[e]=r,o.push(e);else{for(s=0,i=o.length-1;i>s;)l=(s+i)/2|0,t[o[l]]<t[e]?s=l+1:i=l;t[e]<t[o[s]]&&(s>0&&(a[e]=o[s-1]),o[s]=e)}for(s=o.length,i=o[s-1];s-->0;)o[s]=i,i=a[i];return o}function F(t,e,n){var r=t.flags;this.flags=r|V,this.descriptor=t,this.depth=null==e?0:e.depth+1,this.parent=e,this.props=n,0===(r&$)?this.state=null:(this.state=A.create(),this.state.invalidated=this.invalidate,this.state.ctx=this),this.rev=-1,this.root=null,this.element=document.createElement(t.tag),this._update=null,0!==(r&j)&&t.init.call(this)}function E(t){var e=0,n=t.flags,r=t.tag,s=t.updateProps,i=t.updateState,l=t.init,a=t.build,o=t.attached,u=t.detached,f=t.update;return void 0!==n&&(e|=n),void 0===r&&(r="div"),void 0===s?s=null:e|=R,void 0===i?i=null:e|=B|$,void 0===l?l=null:e|=j,void 0===a?a=null:e|=Q,void 0===o?o=null:e|=H,void 0===u?u=null:e|=K,void 0===f?f=null:e|=U,{flags:e,updateProps:s,updateState:i,init:l,build:a,attached:o,detached:u,update:f,tag:r}}function q(t,e,n){return new F(t,n,e)}function P(t,e){e.appendChild(t.element),t.attach(),t.update()}var A=t("./dnode"),M=t("./env"),N=t("./utils").shallowEq,O=1,S=2,D=8,L=16,G=32;n.TEXT=O,n.ELEMENT=S,n.COMPONENT=D,n.ROOT=L;var V=1,B=2,I=32,R=128,$=256,j=512,Q=1024,H=2048,K=4096,U=65536;F.DISABLE_PROPS_CHECK=I,F.prototype.attach=function(){},F.prototype.detach=function(){},F.prototype.updateProps=function(t){var e=this.flags;0!==(e&R)?this.descriptor.updateProps.call(this,t)&&(this.flags|=V):0===(e&I)&&N(this.props,t)||(this.props=t,this.flags|=V)},F.prototype.update=function(){var t=this.flags;if(0!==(t&V)){var e=this.descriptor;0===(t&U)?(0!==(t&$)?(e.updateState.call(this),this.rev<this.state.rev&&this.updateView(e.build.call(this))):this.updateView(e.build.call(this)),this.flags&=~V):e.update.call(this),this.rev=M.scheduler.clock}},F.prototype.updateView=function(t){var e=this.root;null==e?(t.ref=this.element,t.cref=this,p(t,this)):v(e,t,this),this.root=t},F.prototype.invalidate=function(){0===(this.flags&V)&&(this.flags|=V,null==this._update&&(this._update=this.update.bind(this)),M.scheduler.nextFrame().write(this._update,this.depth))},F.prototype.dispose=function(){0!==(this.flags&B)&&this.state.dispose()},e.exports={VNode:n,Component:F,declareComponent:E,create:d,render:p,update:v,createComponent:q,t:r,$t:s,e:i,$e:l,s:a,$s:o,c:u,$c:f,r:h,injectComponent:P}},{"./dnode":2,"./env":3,"./utils":6}],8:[function(t,e){"use strict";function n(t){if(!t)return"";var e=parseFloat(t).toFixed(2);if(t>60){var n=Math.floor(t/60),r=(value%60).toFixed(2).split("."),s=r[0].lpad("0",2),i=r[1];e=n+":"+s+"."+i}return e}var r=t("kivi"),s=r.vdom,i=t("./popover"),l=["label-important"],a=["label-warning"],o=["label-success"],u=s.declareComponent({flags:s.Component.DISABLE_PROPS_CHECK,tag:"tr",build:function(){var t=this.props.db,e=t.getTopFiveQueries(),r=s.e("td");r.type="dbname",r.children=[s.t(t.name)];var u=t.queries.length,f=s.e("span");f.type="label",f.children=[s.t(u)],f.classes=u>=20?l:u>=10?a:o;var h=s.e("td");h.type="query-count",h.children=[f];for(var c=[r,h],d=0;5>d;d++){var p=e[d],v=p.elapsed,g=s.t(n(v)),y=s.c(i,{query:p.query}),m=s.e("td");m.type="Query";var k=[];k.push("elapsed"),k.push(v>=10?"warn_long":v>=1?"warn":"short"),m.classes=k,m.children=[g,y],c.push(m)}var w=s.r();return w.children=c,w}});e.exports=u},{"./popover":10,kivi:4}],9:[function(t,e){"use strict";var n=t("kivi"),r=n.vdom,s=t("./entry"),i=["table","table-striped","latest-data"],l=r.declareComponent({flags:r.Component.DISABLE_PROPS_CHECK,tag:"table",build:function(){for(var t=this.props.dbs,e=[],n=0;n<t.length;n++){var l=t[n];e.push(r.$c(l.id,s,{db:l}))}var a=r.e("tbody");a.children=e;var o=r.r();return o.classes=i,o.children=[a],o}});e.exports=l},{"./entry":8,kivi:4}],10:[function(t,e){"use strict";var n=t("kivi"),r=n.vdom,s=["popover","left"],i=r.declareComponent({build:function(){var t=r.e("div");t.type="popover-content",t.children=[r.t(this.props.query)];var e=r.e("div");e.type="arrow";var n=r.r();return n.classes=s,n.children=[t,e],n}});e.exports=i},{kivi:4}],11:[function(t,e){"use strict";function n(t,e,n){this.elapsed=t,this.waiting=e,this.query=n}function r(t){this.id=s++,this.name=t,this.queries=null,this.update()}n.rand=function(){var t=15*Math.random(),e=Math.random()<.5,r="SELECT blah FROM something";return Math.random()<.2&&(r="<IDLE> in transaction"),Math.random()<.1&&(r="vacuum"),new n(t,e,r)};var s=0;r.prototype.update=function(){for(var t=[],e=Math.floor(10*Math.random()+1),r=0;e>r;r++)t.push(n.rand());this.queries=t},r.prototype.getTopFiveQueries=function(){var t=this.queries.slice();for(t.sort(function(t,e){return t.elapsed-e.elapsed}),t=t.slice(0,5);t.length<5;)t.push(new n(0,!1,""));return t},e.exports={Query:n,Database:r}},{}]},{},[1]);
//# sourceMappingURL=main.js.map